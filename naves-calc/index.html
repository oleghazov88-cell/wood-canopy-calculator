<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –Ω–∞–≤–µ—Å–æ–≤</title>
    <link rel="stylesheet" href="/naves-calc/assets/css/naves-calc.css">
    <style>
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è 3D –æ–∫–Ω–∞ */
        #nc-canvas {
            will-change: transform;
            transform: translateZ(0);
        }
        
        .naves-calc__view {
            position: relative;
            overflow: hidden;
        }
        /* ‚úÖ –£–î–ê–õ–ï–ù–û: CSS —Å—Ç–∏–ª–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ (175 —Å—Ç—Ä–æ–∫) */
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø—Ä–∞–≤–æ–≥–æ –±–ª–æ–∫–∞ —Å 3D –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å test.html */
        .calculator-right-img-block {
            background: white;
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.12);
            border: 1px solid #e9ecef;
            margin-bottom: 30px;
            display: flex;
            flex-direction: column;
            flex: 1;
        }
        
        .path-top {
            margin-bottom: 30px;
        }
        
        .path-top-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 25px;
        }
        
        .price {
            font-family: var(--nc-font-heading);
            font-size: 30px;
            font-weight: 600;
            color: #EB1B24;
        }
        
        .link-360 {
            color: #666;
            text-decoration: none;
            font-size: 15px;
        }
        
        .button-row {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px 20px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
        }
        
        .btn-63 {
            height: 63px;
        }
        
        .bg-red {
            background: linear-gradient(90deg, #EB1B24 0%, #FF5058 100%);
            color: white;
        }
        
        .bg-pink {
            background: linear-gradient(90deg, #FF6B9D 0%, #FF8E9B 100%);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .images-block {
            flex: 1;
            min-height: 400px;
            position: relative;
            border-radius: 10px;
            overflow: hidden;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .images-button {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 10;
        }
        
        .save-btn {
            background: white;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .save-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .path-bottom {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 18px;
            font-weight: 500;
            margin-top: 20px;
        }
        
        .scroll-link {
            color: #EB1B24;
            text-decoration: none;
            line-height: 1.1;
        }
        
        .scroll-link:hover {
            text-decoration: underline;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–¥–ø–∏—Å–µ–π —Å–ª–∞–π–¥–µ—Ä–æ–≤ */
        .slider-description {
            margin-bottom: 10px;
        }
        
        .description-text {
            font-size: 14px;
            color: #666;
            font-style: italic;
            line-height: 1.4;
        }
        
        .naves-calc__view canvas {
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        
        /* –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞–º–µ—Ä–æ–π */
        .camera-controls {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            z-index: 100;
        }
        
        .camera-btn {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .camera-btn:hover {
            background: rgba(32, 181, 185, 0.9);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(32, 181, 185, 0.3);
        }
        
        .camera-btn:active {
            transform: translateY(0);
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –∫–Ω–æ–ø–æ–∫ –∫–∞–º–µ—Ä—ã */
        @media (max-width: 768px) {
            .camera-controls {
                top: 10px;
                right: 10px;
                gap: 6px;
            }
            
            .camera-btn {
                width: 35px;
                height: 35px;
                font-size: 14px;
            }
            
            .calculator-right-img-block {
                padding: 20px;
                border-radius: 15px;
            }
            
            .price {
                font-size: 24px;
            }
            
            .button-row {
                flex-direction: column;
                gap: 10px;
            }
            
            .btn-63 {
                height: 50px;
            }
            
            .images-block {
                min-height: 300px;
            }
            
            .path-bottom {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
            
            .hide_992 {
                display: none !important;
            }
        }
        
        @media (max-width: 576px) {
            .calculator-right-img-block {
                padding: 15px;
                border-radius: 10px;
            }
            
            .price {
                font-size: 20px;
            }
            
            .btn {
                font-size: 14px;
                padding: 12px 16px;
            }
            
            .images-block {
                min-height: 250px;
            }
            
            .images-button {
                top: 10px;
                right: 10px;
            }
            
            .save-btn {
                width: 35px;
                height: 35px;
            }
        }
    </style>
</head>
<body>
    <!-- ‚úÖ –£–î–ê–õ–ï–ù–û: –û—Ç–ª–∞–¥–æ—á–Ω—ã–π –º–∞–∫–µ—Ç (debug-layout) -->

    <!-- –û–†–ò–ì–ò–ù–ê–õ–¨–ù–´–ô –ú–ê–ö–ï–¢ -->
    <div style="display: block;">
        <div class="naves-calc-wrapper">
            <div class="naves-calc">
                <section id="nc-form"></section>
                <section class="naves-calc__view">
                    <div class="calculator-right-img-block">
                        <div class="path-top mb-30">
                            <div class="path-top-info flex aic jcsb mb-25">
                                <div class="price f2 fz30 fw600" id="totalPrice">256 000 ‚ÇΩ</div>
                                <a href="#smeta" class="link-360 fz15 pointer">–ü–æ–¥—Ä–æ–±–Ω–∞—è —Å–º–µ—Ç–∞</a>
                            </div>
                            
                            <div class="button-row flex gap-10">
                                <a href="#" class="btn btn-63 bg-red flex aic jcc fxg fz16 fw600 round-10" onclick="makeOrder()">–°–¥–µ–ª–∞—Ç—å –∑–∞–∫–∞–∑</a>
                                <a href="#" class="btn btn-63 bg-pink flex aic jcc fxg fz16 fw600 round-10" onclick="saveCalculation()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞—Å—á–µ—Ç</a>
                            </div>
                        </div>
                        
                        <div class="images-block flex aic jcc posr bg-f9 round-10">
                            <canvas id="nc-canvas" style="width: 100%; height: 100%;"></canvas>
                        
                        <div class="images-button absolute">
                            <div class="link-360 flex aic pointer fz15">
                                <span style="font-size: 20px; margin-right: 5px;">üîÑ</span>
                                360¬∞
                            </div>
                            <div class="save-btn flex aic jcc pointer round-5 bg-fff" style="width: 40px; height: 40px; margin-top: 10px;" title="–°–∫–∞—á–∞—Ç—å" onclick="download3DImage()">
                                <span style="font-size: 20px;">üíæ</span>
                            </div>
                        </div>
                        <div class="camera-controls">
                            <button class="camera-btn" id="reset-camera" title="–°–±—Ä–æ—Å–∏—Ç—å –≤–∏–¥">üè†</button>
                            <button class="camera-btn" id="top-view" title="–í–∏–¥ —Å–≤–µ—Ä—Ö—É">‚¨ÜÔ∏è</button>
                            <button class="camera-btn" id="front-view" title="–í–∏–¥ —Å–ø–µ—Ä–µ–¥–∏">üëÅÔ∏è</button>
                            <button class="camera-btn" id="side-view" title="–í–∏–¥ —Å–±–æ–∫—É">‚ÜîÔ∏è</button>
                        </div>
                    </div>
                    
                    <div class="path-bottom flex aic jcsb fz18 fz11m fw500">
                        <div class="link-360">
                            üîÑ –ó–∞–∂–º–∏—Ç–µ –ª–µ–≤—É—é –∫–Ω–æ–ø–∫—É –º—ã—à–∏ –¥–ª—è –≤—Ä–∞—â–µ–Ω–∏—è, –∫–æ–ª–µ—Å–∏–∫–æ –¥–ª—è –∑—É–º–∞
                        </div>
                        <a href="#smeta" class="scroll-link red lh110 hide_992">–ü–æ–¥—Ä–æ–±–Ω–∞—è —Å–º–µ—Ç–∞</a>
                    </div>
                </div>
                <div id="nc-summary"></div>
            </section>
        </div>

        <!-- –£—Ç–æ—á–Ω–µ–Ω–∏–µ –¥–∏–∑–∞–π–Ω–∞ -->
        <section class="design-refinement">
            <div class="calculator-hide-date mb-10 mb-0m">
                <div class="triger-open flex aic jcsb f2 fz22 fw600 lh110 ttu pointer">—É—Ç–æ—á–Ω–µ–Ω–∏–µ –¥–∏–∑–∞–π–Ω–∞
                    <div class="arrow flex aic jcc bg-red round-7">‚ñº</div>
                </div>
                <div class="calculator-hide-info hide_cl pt-40">
                    <div class="label_cl fz18 fw600 mb-20">–°—Ç–æ–ª–±—ã</div>
                    <div class="type-row-raido">
                        <div class="type-row-raido-col">
                            <div class="raido-image">
                                <input checked type="radio" name="type-stolbi" id="type-stolbi-1" value="var-1">
                                <label for="type-stolbi-1">
                                    <img src="../stolb/st1 .webp" alt="–°—Ç–æ–ª–± 1" style="width: 100%; height: 100%; object-fit: contain;">
                                </label>
                            </div>
                            <div style="text-align: center; margin-top: 5px; font-size: 13px; color: #666;">
                                <strong>1.</strong> –° –ø–æ–¥–ø—è—Ç–Ω–∏–∫–æ–º<br><span style="font-size: 11px; color: #999;">(–¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–π)</span>
                            </div>
                        </div>
                        <div class="type-row-raido-col">
                            <div class="raido-image">
                                <input type="radio" name="type-stolbi" id="type-stolbi-2" value="var-2">
                                <label for="type-stolbi-2">
                                    <img src="../stolb/st2.webp" alt="–°—Ç–æ–ª–± 2" style="width: 100%; height: 100%; object-fit: contain;">
                                </label>
                            </div>
                            <div style="text-align: center; margin-top: 5px; font-size: 13px; color: #666;">
                                <strong>2.</strong> –°—Ç–æ–ª–± 2
                            </div>
                        </div>
                        <div class="type-row-raido-col">
                            <div class="raido-image">
                                <input type="radio" name="type-stolbi" id="type-stolbi-3" value="var-3">
                                <label for="type-stolbi-3">
                                    <img src="../stolb/st3 .webp" alt="–°—Ç–æ–ª–± 3" style="width: 100%; height: 100%; object-fit: contain;">
                                </label>
                            </div>
                            <div style="text-align: center; margin-top: 5px; font-size: 13px; color: #666;">
                                <strong>3.</strong> –°—Ç–æ–ª–± 3
                            </div>
                        </div>
                        <div class="type-row-raido-col">
                            <div class="raido-image">
                                <input type="radio" name="type-stolbi" id="type-stolbi-4" value="var-4">
                                <label for="type-stolbi-4">
                                    <img src="../stolb/st4.webp" alt="–°—Ç–æ–ª–± 4" style="width: 100%; height: 100%; object-fit: contain;">
                                </label>
                            </div>
                            <div style="text-align: center; margin-top: 5px; font-size: 13px; color: #666;">
                                <strong>4.</strong> –°—Ç–æ–ª–± 4
                            </div>
                        </div>
                        <div class="type-row-raido-col">
                            <div class="raido-image">
                                <input type="radio" name="type-stolbi" id="type-stolbi-5" value="var-5">
                                <label for="type-stolbi-5">
                                    <img src="../stolb/st5.webp" alt="–°—Ç–æ–ª–± 5" style="width: 100%; height: 100%; object-fit: contain;">
                                </label>
                            </div>
                            <div style="text-align: center; margin-top: 5px; font-size: 13px; color: #666;">
                                <strong>5.</strong> –° –ø–æ–¥–ø—è—Ç–Ω–∏–∫–æ–º<br><span style="font-size: 11px; color: #999;">(–¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–π)</span>
                            </div>
                        </div>
                        <div class="type-row-raido-col">
                            <div class="raido-image">
                                <input type="radio" name="type-stolbi" id="type-stolbi-6" value="var-6">
                                <label for="type-stolbi-6">
                                    <img src="../stolb/st6.webp" alt="–°—Ç–æ–ª–± 6" style="width: 100%; height: 100%; object-fit: contain;">
                                </label>
                            </div>
                            <div style="text-align: center; margin-top: 5px; font-size: 13px; color: #666;">
                                <strong>6.</strong> –°—Ç–æ–ª–± 6
                            </div>
                        </div>
                    </div>

                    <div class="label_cl fz18 fw600 mb-20">–†–∞—Å–∫–æ—Å—ã</div>
                    <div class="type-row-raido">
                        <div class="type-row-raido-col">
                            <div class="raido-image">
                                <input checked type="radio" name="type-raskosi" id="type-raskosi-var-1">
                                <label for="type-raskosi-var-1">
                                    <img src="../raskos/1 (1).webp" alt="–†–∞—Å–∫–æ—Å 1" style="width: 60px; height: 60px; object-fit: cover;">
                                </label>
                            </div>
                        </div>
                        <div class="type-row-raido-col">
                            <div class="raido-image">
                                <input type="radio" name="type-raskosi" id="type-raskosi-var-2">
                                <label for="type-raskosi-var-2">
                                    <img src="../raskos/2 (1).webp" alt="–†–∞—Å–∫–æ—Å 2" style="width: 60px; height: 60px; object-fit: cover;">
                                </label>
                            </div>
                        </div>
                        <div class="type-row-raido-col">
                            <div class="raido-image">
                                <input type="radio" name="type-raskosi" id="type-raskosi-var-3">
                                <label for="type-raskosi-var-3">
                                    <img src="../raskos/3 (1).webp" alt="–†–∞—Å–∫–æ—Å 3" style="width: 60px; height: 60px; object-fit: cover;">
                                </label>
                            </div>
                        </div>
                        <div class="type-row-raido-col">
                            <div class="raido-image">
                                <input type="radio" name="type-raskosi" id="type-raskosi-var-4">
                                <label for="type-raskosi-var-4">
                                    <img src="../raskos/4 (1).webp" alt="–†–∞—Å–∫–æ—Å 4" style="width: 60px; height: 60px; object-fit: cover;">
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="label_cl">–®–∞–≥ —Å—Ç–æ–ª–±–æ–≤</div>
                    <div class="slider-description mb-10">
                        <span class="description-text">–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Å—Ç–æ–ª–±–∞–º–∏ –Ω–∞–≤–µ—Å–∞</span>
                    </div>
                    <dl>
                        <dt class="name">—à–∞–≥ —Å—Ç–æ–ª–±–æ–≤, –º</dt>
                        <dd class="has-slider" data-min="1.0" data-max="3.5" data-value="2.5">
                            <div class="ot">–æ—Ç<br>1.0–º</div>
                            <div class="value"><span>2.5</span>–º</div>
                            <div class="do">–¥–æ<br>3.5–º</div>
                            <div class="ui-container">
                                <input type="range" class="slider" min="10" max="35" step="1" value="25" id="columnStep">
                            </div>
                        </dd>
                    </dl>
                </div>
            </div>
        </section>

        <!-- –£—Ç–æ—á–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–∞—Ä–∫–∞—Å–∞ -->
        <section class="frame-params-refinement">
            <div class="calculator-hide-date mb-10 mb-0m">
                <div class="triger-open flex aic jcsb f2 fz22 fw600 lh110 ttu pointer">—É—Ç–æ—á–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–∞—Ä–∫–∞—Å–∞
                    <div class="arrow flex aic jcc bg-red round-7">‚ñº</div>
                </div>
                <div class="calculator-hide-info hide_cl pt-40">
                    <!-- –ë–ª–æ–∫ –ö–∞—Ä–∫–∞—Å -->
                    <div class="f2 fz16 fw600 lh140 ttu mb-30">–ö–∞—Ä–∫–∞—Å</div>
                    <div class="field-row flex fxww mb-40">
                        <div class="field-col">
                            <div class="label_cl fz18 fw600 mb-20">–ú–∞—Ç–µ—Ä–∏–∞–ª –∫–∞—Ä–∫–∞—Å–∞</div>
                            <select class="select" id="frameMaterial">
                                <option value="pine">–°–æ—Å–Ω–∞</option>
                                <option value="larch">–õ–∏—Å—Ç–≤–µ–Ω–Ω–∏—Ü–∞</option>
                                <option value="oak">–î—É–±</option>
                                <option value="spruce">–ï–ª—å</option>
                            </select>
                        </div>
                        <div class="field-col">
                            <div class="label_cl fz18 fw600 mb-20">–ú–∞—Ç–µ—Ä–∏–∞–ª —Å—Ç–æ–ª–±–æ–≤</div>
                            <select class="select" id="postMaterial">
                                <option value="glued-100x100">–ö–ª–µ–µ–Ω—ã–π –±—Ä—É—Å 100√ó100√ó6000 –º–º</option>
                                <option value="glued-200x200">–ö–ª–µ–µ–Ω—ã–π –±—Ä—É—Å 200√ó200√ó6000 –º–º</option>
                                <option value="glued-240x140">–ö–ª–µ–µ–Ω—ã–π –±—Ä—É—Å 240√ó140 –º–º</option>
                                <option value="glued-150x150">–ö–ª–µ–µ–Ω—ã–π –±—Ä—É—Å 150√ó150√ó6000 –º–º</option>
                                <option value="planed-90x90">–°—Ç—Ä–æ–≥–∞–Ω—ã–π –±—Ä—É—Å 90√ó90√ó6000 –º–º</option>
                                <option value="planed-140x140">–°—Ç—Ä–æ–≥–∞–Ω—ã–π –±—Ä—É—Å 140√ó140√ó6000 –º–º</option>
                                <option value="planed-190x190">–°—Ç—Ä–æ–≥–∞–Ω—ã–π –±—Ä—É—Å 190√ó190√ó6000 –º–º</option>
                            </select>
                        </div>
                        <div class="field-col">
                            <div class="label_cl fz18 fw600 mb-20">–ú–∞—Ç–µ—Ä–∏–∞–ª —Ñ–µ—Ä–º</div>
                            <select class="select" id="trussMaterial">
                                <option value="planed-45x190">–°—Ç—Ä–æ–≥–∞–Ω–∞—è –¥–æ—Å–∫–∞ 45√ó190 –º–º</option>
                                <option value="planed-35x190">–°—Ç—Ä–æ–≥–∞–Ω–∞—è –¥–æ—Å–∫–∞ 35√ó190 –º–º</option>
                                <option value="planed-50x150">–°—Ç—Ä–æ–≥–∞–Ω–∞—è –¥–æ—Å–∫–∞ 50√ó150 –º–º</option>
                            </select>
                        </div>
                    </div>
                    <div class="field-row">
                        <div class="field-col">
                            <div class="label_cl fz18 fw600 mb-20">–û–∫—Ä–∞—Å</div>
                            <select class="select" id="frameColoring">
                                <option value="no-coloring">–ë–µ–∑ –æ–∫—Ä–∞—Å–∞</option>
                                <option value="neomid">Neomid, –ø—Ä–æ–ø–∏—Ç–∫–∞</option>
                                <option value="texturol-landscape">–¢–µ–∫—Å—Ç—É—Ä–æ–ª –õ–∞–Ω–¥—à–∞—Ñ—Ç, –ø–æ–ª—É—É–∫—Ä—ã–≤–Ω–∞—è, –ø–æ–ª—É–º–∞—Ç–æ–≤–∞—è (—Å–≤–µ—Ç–ª—ã–µ RAL, –∑–∞–≤–æ–¥—Å–∫–∏–µ —Ü–≤–µ—Ç–∞)</option>
                                <option value="texturol-country">–¢–µ–∫—Å—Ç—É—Ä–æ–ª –ö–∞–Ω—Ç—Ä–∏, —É–∫—Ä—ã–≤–Ω–∞—è, –ø–æ–ª—É–º–∞—Ç–æ–≤–∞—è (–ª—é–±—ã–µ —Ü–≤–µ—Ç–∞ –ø–æ RAL)</option>
                                <option value="symphony-wood-guard">Symphony wood-guard, –ø–æ–ª—É–º–∞—Ç–æ–≤–∞—è</option>
                                <option value="olsta">Olsta, –º–∞—Ç–æ–≤–∞—è</option>
                                <option value="tikkurila">Tikkurila</option>
                            </select>
                        </div>
                    </div>
                    <div class="field-row">
                        <div class="field-col">
                            <div class="slider-description mb-10">
                                <span class="description-text">–í—ã—Å—Ç—É–ø –±–∞–ª–∫–∏ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –ø–µ—Ä–µ–¥–Ω–∏—Ö —Å—Ç–æ–ª–±–æ–≤</span>
                            </div>
                            <dl>
                                <dt class="name">–≤—ã–ø—É—Å–∫ –±–∞–ª–∫–∏ —Å–ø–µ—Ä–µ–¥–∏, –º–º</dt>
                                <dd class="has-slider" data-min="0" data-max="500" data-value="200">
                                    <div class="ot">–æ—Ç<br>0–º–º</div>
                                    <div class="value"><span>200</span>–º–º</div>
                                    <div class="do">–¥–æ<br>500–º–º</div>
                                    <div class="ui-container">
                                        <input type="range" class="slider" min="0" max="500" step="10" value="200" id="frontBeamExtension">
                                    </div>
                                </dd>
                            </dl>
                        </div>
                        <div class="field-col">
                            <div class="slider-description mb-10">
                                <span class="description-text">–í—ã—Å—Ç—É–ø –±–∞–ª–∫–∏ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –∑–∞–¥–Ω–∏—Ö —Å—Ç–æ–ª–±–æ–≤</span>
                            </div>
                            <dl>
                                <dt class="name">–≤—ã–ø—É—Å–∫ –±–∞–ª–∫–∏ —Å–∑–∞–¥–∏, –º–º</dt>
                                <dd class="has-slider" data-min="0" data-max="500" data-value="200">
                                    <div class="ot">–æ—Ç<br>0–º–º</div>
                                    <div class="value"><span>200</span>–º–º</div>
                                    <div class="do">–¥–æ<br>500–º–º</div>
                                    <div class="ui-container">
                                        <input type="range" class="slider" min="0" max="500" step="10" value="200" id="backBeamExtension">
                                    </div>
                                </dd>
                            </dl>
                        </div>
                    </div>

                    <!-- –ë–ª–æ–∫ –ö—Ä–æ–≤–ª—è -->
                    <div class="f2 fz16 fw600 lh140 ttu mb-30">–ö—Ä–æ–≤–ª—è</div>
                    <div class="field-row flex fxww mb-40">
                        <div class="field-col">
                            <div class="label_cl fz18 fw600 mb-20">–ú–∞—Ç–µ—Ä–∏–∞–ª –∫—Ä–æ–≤–ª–∏</div>
                            <select class="select" id="roofingMaterial">
                                <option value="metal-grandline" selected>–ú–µ—Ç–∞–ª–ª–æ—á–µ—Ä–µ–ø–∏—Ü–∞ Grand Line 0.45 –º–º + —Å–Ω–µ–≥–æ–∑–∞–¥–µ—Ä–∂–∞—Ç–µ–ª–∏</option>
                                <option value="shinglas-sonata">–ì–∏–±–∫–∞—è —á–µ—Ä–µ–ø–∏—Ü–∞ Shinglas –§–∏–Ω—Å–∫–∞—è –°–æ–Ω–∞—Ç–∞</option>
                                <option value="profiled-gl35r">–ö—Ä–æ–≤–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–Ω–∞—Å—Ç–∏–ª GL 35R</option>
                                <option value="polycarbonate-8mm">–ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π –ø–æ–ª–∏–∫–∞—Ä–±–æ–Ω–∞—Ç, 8 –º–º</option>
                                <option value="no-roofing">–ë–µ–∑ –∫—Ä–æ–≤–ª–∏</option>
                            </select>
                        </div>
                        <div class="field-col">
                            <div class="label_cl fz18 fw600 mb-20">–¶–≤–µ—Ç –∫—Ä–æ–≤–ª–∏</div>
                            <select class="select" id="roofColor">
                                <option value="amber">–Ø–Ω—Ç–∞—Ä—å</option>
                                <option value="blue">–°–∏–Ω–∏–π</option>
                                <option value="green">–ó–µ–ª–µ–Ω—ã–π</option>
                                <option value="red">–ö—Ä–∞—Å–Ω—ã–π</option>
                                <option value="brown">–ö–æ—Ä–∏—á–Ω–µ–≤—ã–π</option>
                                <option value="gray">–°–µ—Ä—ã–π</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞–≤–µ—Å–∞ -->
    <section class="specification" id="smeta">
        <h2>—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞–≤–µ—Å–∞</h2>
        <div class="mb-30">
            <dl>
                <dt class="flex aic f2 pointer">
                    <div class="num">01.</div>
                    <div class="name">–æ–±—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</div>
                    <div class="arrow">‚ñº</div>
                </dt>
                <dd>
                    <ul>
                        <li>
                            <div class="num">1.1</div>
                            <div class="parameter">–¢–∏–ø –Ω–∞–≤–µ—Å–∞</div>
                            <div class="value" id="specRoofType">–î–≤—É—Å–∫–∞—Ç–Ω—ã–π</div>
                        </li>
                        <li>
                            <div class="num">1.2</div>
                            <div class="parameter">–ú–∞—Ç–µ—Ä–∏–∞–ª –∫–∞—Ä–∫–∞—Å–∞</div>
                            <div class="value" id="specFrameMaterial">–°–æ—Å–Ω–∞</div>
                        </li>
                        <li>
                            <div class="num">1.3</div>
                            <div class="parameter">–ú–∞—Ç–µ—Ä–∏–∞–ª –∫—Ä–æ–≤–ª–∏</div>
                            <div class="value" id="specRoofingMaterial">–ú–µ—Ç–∞–ª–ª–æ—á–µ—Ä–µ–ø–∏—Ü–∞</div>
                        </li>
                        <li>
                            <div class="num">1.4</div>
                            <div class="parameter">–¶–≤–µ—Ç –∫—Ä–æ–≤–ª–∏</div>
                            <div class="value" id="specRoofColor">–Ø–Ω—Ç–∞—Ä—å</div>
                        </li>
                        <li>
                            <div class="num">1.5</div>
                            <div class="parameter">–ü–ª–æ—â–∞–¥—å</div>
                            <div class="value" id="specArea">66.0–º¬≤</div>
                        </li>
                        <li>
                            <div class="num">1.6</div>
                            <div class="parameter">–®–∏—Ä–∏–Ω–∞ –ø–æ –æ—Å—è–º</div>
                            <div class="value" id="specWidth">6 000 –º–º</div>
                        </li>
                        <li>
                            <div class="num">1.7</div>
                            <div class="parameter">–î–ª–∏–Ω–∞ –ø–æ —Ä–∏–≥–µ–ª—é</div>
                            <div class="value" id="specLength">11 400 –º–º</div>
                        </li>
                        <li>
                            <div class="num">1.8</div>
                            <div class="parameter">–í—ã—Å–æ—Ç–∞ —Å—Ç–æ–ª–±–æ–≤</div>
                            <div class="value" id="specHeight">3 000 –º–º</div>
                        </li>
                        <li>
                            <div class="num">1.9</div>
                            <div class="parameter">–í—ã—Å–æ—Ç–∞ —Å–∫–∞—Ç–æ–≤</div>
                            <div class="value" id="specRoofHeight">1 500 –º–º</div>
                        </li>
                        <li>
                            <div class="num">1.10</div>
                            <div class="parameter">–®–∞–≥ —Å—Ç–æ–ª–±–æ–≤</div>
                            <div class="value" id="specPostSpacing">2 500 –º–º</div>
                        </li>
                    </ul>
                </dd>
            </dl>
            <dl>
                <dt class="flex aic f2 pointer">
                    <div class="num">02.</div>
                    <div class="name">—Å—Ç–æ–ª–±—ã</div>
                    <div class="arrow">‚ñº</div>
                </dt>
                <dd>
                    <ul>
                        <li>
                            <div class="num">2.1</div>
                            <div class="parameter">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ–ª–±–æ–≤</div>
                            <div class="value" id="specPosts">10 —à—Ç.</div>
                        </li>
                        <li>
                            <div class="num">2.2</div>
                            <div class="parameter">–¢–∏–ø —Å—Ç–æ–ª–±–æ–≤</div>
                            <div class="value" id="specPostType">–ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –±—Ä—É—Å</div>
                        </li>
                        <li>
                            <div class="num">2.3</div>
                            <div class="parameter">–ú–∞—Ç–µ—Ä–∏–∞–ª —Å—Ç–æ–ª–±–æ–≤</div>
                            <div class="value" id="specPostMaterial">–°–æ—Å–Ω–∞</div>
                        </li>
                        <li>
                            <div class="num">2.4</div>
                            <div class="parameter">–í—ã—Å–æ—Ç–∞ —Å—Ç–æ–ª–±–æ–≤ —Å–ª–µ–≤–∞</div>
                            <div class="value" id="specHeightLeft">3 000 –º–º</div>
                        </li>
                        <li>
                            <div class="num">2.5</div>
                            <div class="parameter">–í—ã—Å–æ—Ç–∞ —Å—Ç–æ–ª–±–æ–≤ —Å–ø—Ä–∞–≤–∞</div>
                            <div class="value" id="specHeightRight">3 000 –º–º</div>
                        </li>
                        <li>
                            <div class="num">2.6</div>
                            <div class="parameter">–°–µ—á–µ–Ω–∏–µ —Å—Ç–æ–ª–±–æ–≤</div>
                            <div class="value" id="specPostSection">150 x 150 –º–º</div>
                        </li>
                    </ul>
                </dd>
            </dl>
            <dl>
                <dt class="flex aic f2 pointer">
                    <div class="num">03.</div>
                    <div class="name">–§–µ—Ä–º—ã</div>
                    <div class="arrow">‚ñº</div>
                </dt>
                <dd>
                    <ul>
                        <li>
                            <div class="num">3.1</div>
                            <div class="parameter">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–µ—Ä–º</div>
                            <div class="value" id="specFarms">5 —à—Ç.</div>
                        </li>
                        <li>
                            <div class="num">3.2</div>
                            <div class="parameter">–ú–∞—Ç–µ—Ä–∏–∞–ª —Ñ–µ—Ä–º</div>
                            <div class="value" id="specTrussMaterial">–°—Ç—Ä–æ–≥–∞–Ω–∞—è –¥–æ—Å–∫–∞ 45√ó190 –º–º</div>
                        </li>
                        <li>
                            <div class="num">3.3</div>
                            <div class="parameter">–î–ª–∏–Ω–∞ —Ñ–µ—Ä–º—ã</div>
                            <div class="value" id="specFarmLength">6 000 –º–º</div>
                        </li>
                        <li>
                            <div class="num">3.4</div>
                            <div class="parameter">–®–∞–≥ —Ñ–µ—Ä–º</div>
                            <div class="value" id="specTrussSpacing">2 500 –º–º</div>
                        </li>
                    </ul>
                </dd>
            </dl>
            <dl>
                <dt class="flex aic f2 pointer">
                    <div class="num">04.</div>
                    <div class="name">–†–∞—Å–∫–æ—Å—ã</div>
                    <div class="arrow">‚ñº</div>
                </dt>
                <dd>
                    <ul>
                        <li>
                            <div class="num">4.1</div>
                            <div class="parameter">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—Å–∫–æ—Å–æ–≤</div>
                            <div class="value" id="specBraces">20 —à—Ç.</div>
                        </li>
                        <li>
                            <div class="num">4.2</div>
                            <div class="parameter">–¢–∏–ø —Ä–∞—Å–∫–æ—Å–æ–≤</div>
                            <div class="value" id="specBraceType">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π</div>
                        </li>
                        <li>
                            <div class="num">4.3</div>
                            <div class="parameter">–ú–∞—Ç–µ—Ä–∏–∞–ª —Ä–∞—Å–∫–æ—Å–æ–≤</div>
                            <div class="value" id="specBraceMaterial">–°–æ—Å–Ω–∞</div>
                        </li>
                        <li>
                            <div class="num">4.4</div>
                            <div class="parameter">–°–µ—á–µ–Ω–∏–µ —Ä–∞—Å–∫–æ—Å–æ–≤</div>
                            <div class="value">50 x 100 –º–º</div>
                        </li>
                        <li>
                            <div class="num">4.5</div>
                            <div class="parameter">–î–ª–∏–Ω–∞ —Ä–∞—Å–∫–æ—Å–æ–≤</div>
                            <div class="value">1 500 –º–º</div>
                        </li>
                    </ul>
                </dd>
            </dl>
        </div>
    </section>
    </div>
    
    <!-- ====================================== -->
    <!-- MVP ARCHITECTURE SCRIPTS              -->
    <!-- ====================================== -->
    
    <!-- –ú–æ–¥—É–ª–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ -->
    <script src="assets/js/storage-manager.js"></script>
    <script src="assets/js/order-manager.js"></script>
    <script src="assets/js/pdf-export.js"></script>
    
    <!-- MVP Core Components -->
    <script src="assets/js/mvp/CanopyModel.js"></script>
    <script src="assets/js/mvp/CanopyView.js"></script>
    
    <!-- Three.js Dependencies -->
    <script src="assets/libs/three/three.min.js"></script>
    <script src="assets/libs/three/OrbitControls-wrapper.js"></script>
    <!-- GLTFLoader –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ 3D –º–æ–¥–µ–ª–µ–π —Ä–∞—Å–∫–æ—Å–æ–≤ -->
    <script src="assets/libs/three/GLTFLoader.js"></script>
    
    <!-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ THREE.js –±–∏–±–ª–∏–æ—Ç–µ–∫ -->
    <script>
        console.log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ THREE.js –±–∏–±–ª–∏–æ—Ç–µ–∫:');
        console.log('  THREE:', typeof THREE !== 'undefined' ? '‚úÖ' : '‚ùå');
        console.log('  THREE.OrbitControls:', typeof THREE.OrbitControls !== 'undefined' ? '‚úÖ' : '‚ùå');
        console.log('  THREE.GLTFLoader:', typeof THREE.GLTFLoader !== 'undefined' ? '‚úÖ' : '‚ùå');
        
        if (typeof THREE.GLTFLoader === 'undefined') {
            console.error('‚ùå –ö–†–ò–¢–ò–ß–ù–û: THREE.GLTFLoader –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª GLTFLoader.js');
        } else {
            console.log('‚úÖ –í—Å–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ THREE.js –∑–∞–≥—Ä—É–∂–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ');
        }
    </script>
    
    <!-- MVP Renderer & Presenter -->
    <script src="assets/js/mvp/Canopy3DRenderer.js"></script>
    <script src="assets/js/mvp/CanopyPresenter.js"></script>
    
    <!-- MVP App Initialization -->
    <script src="assets/js/mvp/app.js"></script>
    
    <script>
        window.addEventListener('DOMContentLoaded', () => {
            // MVP –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ app.js
            // –î–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é —á–µ—Ä–µ–∑ window.CanopyApp
            
            // –°–æ–∑–¥–∞–µ–º –æ–±–µ—Ä—Ç–∫—É –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
            setTimeout(() => {
                if (window.CanopyApp && window.CanopyApp.renderer) {
                    window.NavesCalc = {
                        camera: window.CanopyApp.renderer.camera,
                        controls: window.CanopyApp.renderer.controls,
                        renderer: window.CanopyApp.renderer.renderer,
                        scene: window.CanopyApp.renderer.scene,
                        params: window.CanopyApp.model.params,
                        currentPostSpacing: window.CanopyApp.model.params.postSpacing / 10,
                        needsRender: true,
                        
                        update3DModel: () => {
                            window.CanopyApp.presenter.update3DModelImmediately();
                        },
                        calculateTotal: () => {
                            window.CanopyApp.presenter.calculateAndUpdate();
                        },
                        updateSpecification: () => {
                            window.CanopyApp.presenter.calculateAndUpdate();
                        },
                        updateParam: (key, value) => {
                            window.CanopyApp.model.updateParam(key, value);
                            window.CanopyApp.presenter.calculateAndUpdate();
                            window.CanopyApp.presenter.update3DModelDebounced();
                        },
                        setQualityLevelManual: (level) => {
                            if (window.CanopyApp.renderer.setQualityLevel) {
                                window.CanopyApp.renderer.setQualityLevel(level);
                            }
                        },
                        qualityLevel: 'high'
                    };
                    console.log('‚úÖ –û–±–µ—Ä—Ç–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ window.NavesCalc —Å–æ–∑–¥–∞–Ω–∞');
                }
            }, 500);
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Å–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è/—Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏—è –±–ª–æ–∫–æ–≤
            initCollapsibleBlocks();
            
            // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            syncDefaultValues();
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–æ–ª—â–∏–Ω—É —Å—Ç–æ–ª–±–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–µ—á–µ–Ω–∏—è
            setTimeout(() => {
                updatePostThickness();
            }, 100);
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞–º–µ—Ä–æ–π
            setTimeout(() => {
                initCameraControls();
            }, 600);
            
            // –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            PerformanceOptimizer.optimizeForDevice();
            
            console.log('‚úÖ MVP Architecture –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞');
            console.log('üì¶ –î–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ window.CanopyApp');
        });
        
        function initCollapsibleBlocks() {
            // –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ –±–ª–æ–∫–∏ —Å –∫–ª–∞—Å—Å–æ–º triger-open
            const triggerElements = document.querySelectorAll('.triger-open');
            
            triggerElements.forEach(trigger => {
                trigger.addEventListener('click', function() {
                    const infoBlock = this.nextElementSibling;
                    const arrow = this.querySelector('.arrow');
                    
                    if (infoBlock && infoBlock.classList.contains('calculator-hide-info')) {
                        // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –∫–ª–∞—Å—Å—ã
                        this.classList.toggle('active');
                        infoBlock.classList.toggle('active');
                        
                        // –ê–Ω–∏–º–∞—Ü–∏—è —Å—Ç—Ä–µ–ª–∫–∏
                        if (arrow) {
                            arrow.style.transform = this.classList.contains('active') ? 'rotate(180deg)' : 'rotate(0deg)';
                        }
                    }
                });
            });
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–∞–π–¥–µ—Ä–æ–≤
            initSliders();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ–ª–µ–∫—Ç–æ–≤
            initSelects();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–¥–∏–æ–∫–Ω–æ–ø–æ–∫
            initRadioButtons();
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–¥–∏–æ–∫–Ω–æ–ø–æ–∫ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
        }
        
        // –°–∏—Å—Ç–µ–º–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        const PerformanceOptimizer = {
            debounceTimers: new Map(),
            updateQueue: new Set(),
            
            // Debounced –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–ª—è —Å–ª–∞–π–¥–µ—Ä–æ–≤
            debouncedUpdate(sliderId, callback, delay = 300) {
                // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ç–∞–π–º–µ—Ä
                if (this.debounceTimers.has(sliderId)) {
                    clearTimeout(this.debounceTimers.get(sliderId));
                }
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤—ã–π —Ç–∞–π–º–µ—Ä
                const timer = setTimeout(() => {
                    try {
                        callback();
                        this.debounceTimers.delete(sliderId);
                    } catch (error) {
                        console.error('–û—à–∏–±–∫–∞ –≤ debounced –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏:', error);
                    }
                }, delay);
                
                this.debounceTimers.set(sliderId, timer);
            },
            
            // Batch –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
            batchUpdate(updateFn) {
                this.updateQueue.add(updateFn);
                
                // –í—ã–ø–æ–ª–Ω—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ —Å–ª–µ–¥—É—é—â–µ–º –∫–∞–¥—Ä–µ
                requestAnimationFrame(() => {
                    this.updateQueue.forEach(fn => {
                        try {
                            fn();
                        } catch (error) {
                            console.error('–û—à–∏–±–∫–∞ –≤ batch –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏:', error);
                        }
                    });
                    this.updateQueue.clear();
                });
            },
            
            // –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
            optimizeForDevice() {
                const isLowEnd = navigator.hardwareConcurrency <= 2 || 
                                navigator.deviceMemory <= 4 ||
                                /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
                
                if (isLowEnd) {
                    console.log('–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ —Å–ª–∞–±–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, –ø—Ä–∏–º–µ–Ω—è–µ–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏...');
                    
                    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                    if (window.NavesCalc) {
                        window.NavesCalc.qualityLevel = 'low';
                        window.NavesCalc.setQualityLevelManual('low');
                    }
                    
                    // –£–º–µ–Ω—å—à–∞–µ–º —á–∞—Å—Ç–æ—Ç—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
                    this.debounceDelay = 500;
                    
                    // –°–∫—Ä—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
                    const panel = document.getElementById('performance-panel');
                    if (panel && window.innerWidth < 768) {
                        panel.classList.add('hidden');
                    }
                }
                
                return isLowEnd;
            }
        };
        
        function initSliders() {
            const sliders = document.querySelectorAll('.slider');
            
            sliders.forEach(slider => {
                slider.addEventListener('input', function() {
                    const valueSpan = this.closest('.has-slider').querySelector('.value span');
                    if (!valueSpan) return;
                    
                    // –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
                    let displayValue = this.value;
                    
                    if (this.id === 'columnStep') {
                        displayValue = (this.value / 10).toFixed(1);
                    }
                    
                    valueSpan.textContent = displayValue;
                    
                    // Debounced –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ 3D –º–æ–¥–µ–ª–∏
                    PerformanceOptimizer.debouncedUpdate(this.id, () => {
                        try {
                            updateSliderValue(this);
                        } catch (error) {
                            console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ª–∞–π–¥–µ—Ä–∞:', error);
                            showError('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞');
                        }
                    }, PerformanceOptimizer.debounceDelay || 300);
                });
            });
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–ª–∞–π–¥–µ—Ä–∞ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
        function updateSliderValue(slider) {
            if (!window.NavesCalc) {
                console.warn('NavesCalc –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω');
                return;
            }
            
            const value = parseInt(slider.value);
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π
            if (isNaN(value) || value < 0) {
                console.error('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–ª–∞–π–¥–µ—Ä–∞:', slider.value);
                return;
            }
            
            try {
                switch (slider.id) {
                    case 'columnStep':
                        window.NavesCalc.currentPostSpacing = value / 10;
                        break;
                    case 'frontBeamExtension':
                        window.NavesCalc.params.frontBeamExtension = value;
                        break;
                    case 'backBeamExtension':
                        window.NavesCalc.params.backBeamExtension = value;
                        break;
                }
                
                // Batch –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                PerformanceOptimizer.batchUpdate(() => {
                    if (window.NavesCalc.update3DModel) {
                        window.NavesCalc.update3DModel();
                    }
                    if (window.NavesCalc.calculateTotal) {
                        window.NavesCalc.calculateTotal();
                    }
                    if (window.NavesCalc.updateSpecification) {
                        window.NavesCalc.updateSpecification();
                    }
                });
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:', error);
                showError('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞');
            }
        }
        
        // –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö
        function showError(message) {
            // –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #ff4444;
                color: white;
                padding: 10px 15px;
                border-radius: 5px;
                z-index: 10000;
                font-size: 14px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 3000);
        }
        
        function initSelects() {
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Å–µ–ª–µ–∫—Ç–æ–≤ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
            const frameMaterialSelect = document.getElementById('frameMaterial');
            const postMaterialSelect = document.getElementById('postMaterial');
            const trussMaterialSelect = document.getElementById('trussMaterial');
            const braceTypeSelect = document.getElementById('braceType');
            const frameColoringSelect = document.getElementById('frameColoring');
            const roofingMaterialSelect = document.getElementById('roofingMaterial');
            const roofColorSelect = document.getElementById('roofColor');
            
            if (frameMaterialSelect) {
                frameMaterialSelect.addEventListener('change', function() {
                    if (window.NavesCalc) {
                        window.NavesCalc.params.frameMaterial = this.value;
                        window.NavesCalc.update3DModel();
                        window.NavesCalc.calculateTotal();
                        window.NavesCalc.updateSpecification();
                    }
                });
            }
            
            if (postMaterialSelect) {
                postMaterialSelect.addEventListener('change', function() {
                    if (window.NavesCalc) {
                        window.NavesCalc.params.postMaterial = this.value;
                        updatePostThickness(); // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—â–∏–Ω—É —Å—Ç–æ–ª–±–∞ var-5
                        window.NavesCalc.update3DModel();
                        window.NavesCalc.calculateTotal();
                        window.NavesCalc.updateSpecification();
                    }
                });
            }
            
            if (trussMaterialSelect) {
                trussMaterialSelect.addEventListener('change', function() {
                    if (window.CanopyApp && window.CanopyApp.presenter) {
                        window.CanopyApp.presenter.onViewParamChanged('trussMaterial', this.value);
                    }
                });
            }
            
            if (braceTypeSelect) {
                braceTypeSelect.addEventListener('change', function() {
                    if (window.NavesCalc) {
                        window.NavesCalc.params.braceType = this.value;
                        window.NavesCalc.update3DModel();
                        window.NavesCalc.calculateTotal();
                        window.NavesCalc.updateSpecification();
                    }
                });
            }
            
            if (frameColoringSelect) {
                frameColoringSelect.addEventListener('change', function() {
                    if (window.NavesCalc) {
                        window.NavesCalc.params.frameColoring = this.value;
                        window.NavesCalc.update3DModel();
                        window.NavesCalc.calculateTotal();
                        window.NavesCalc.updateSpecification();
                    }
                });
            }
            
            if (roofingMaterialSelect) {
                roofingMaterialSelect.addEventListener('change', function() {
                    if (window.NavesCalc) {
                        window.NavesCalc.params.roofingMaterial = this.value;
                        window.NavesCalc.update3DModel();
                        window.NavesCalc.calculateTotal();
                        window.NavesCalc.updateSpecification();
                    }
                });
            }
            
            if (roofColorSelect) {
                roofColorSelect.addEventListener('change', function() {
                    if (window.NavesCalc) {
                        window.NavesCalc.params.roofColor = this.value;
                        window.NavesCalc.update3DModel();
                        window.NavesCalc.calculateTotal();
                        window.NavesCalc.updateSpecification();
                    }
                });
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–ª—â–∏–Ω—ã —Å—Ç–æ–ª–±–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–µ—á–µ–Ω–∏—è —Å—Ç–æ–ª–±–æ–≤
        function updatePostThickness() {
            if (!window.NavesCalc || !window.NavesCalc.params) return;
            
            const postType = window.NavesCalc.params.postType;
            const postMaterial = window.NavesCalc.params.postMaterial;
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–æ–ª—â–∏–Ω—É –¥–ª—è —Å—Ç–æ–ª–±–æ–≤ —Å –ø–æ–¥–ø—è—Ç–Ω–∏–∫–æ–º –∏–ª–∏ –∫–∞–ø–∏—Ç–µ–ª—å—é
            if (postMaterial) {
                // –ò–∑–≤–ª–µ–∫–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –∏–∑ –∑–Ω–∞—á–µ–Ω–∏—è postMaterial (–Ω–∞–ø—Ä–∏–º–µ—Ä, "glued-150x150" -> 150)
                const sizeMatch = postMaterial.match(/(\d+)x(\d+)/);
                if (sizeMatch) {
                    const width = parseFloat(sizeMatch[1]);
                    const height = parseFloat(sizeMatch[2]);
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–∞–∑–º–µ—Ä—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ NavesCalc
                    window.NavesCalc.params.postWidth = width / 1000; // –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ –º–µ—Ç—Ä—ã
                    window.NavesCalc.params.postDepth = height / 1000; // –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ –º–µ—Ç—Ä—ã
                    
                    // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–ø—è—Ç–Ω–∏–∫–∞ (–¥–ª—è var-5, var-4)
                    const footOverhang = 40; // –≤—ã—Å—Ç—É–ø —Å –∫–∞–∂–¥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã –≤ –º–º
                    const footThickness = 40; // —Ç–æ–ª—â–∏–Ω–∞ –ø—è—Ç–∫–∏ –≤ –º–º
                    
                    // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞–ø–∏—Ç–µ–ª–∏ (–¥–ª—è var-3, var-4)
                    const capitalOverhang = 50; // —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å –∫–∞–∂–¥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã –≤ –º–º
                    const capitalThickness = 80; // –≤—ã—Å–æ—Ç–∞ –∫–∞–ø–∏—Ç–µ–ª–∏ –≤ –º–º
                    
                    if (postType === 'var-5' || postType === 'var-4') {
                        window.NavesCalc.params.postFootWidth = (width + footOverhang * 2) / 1000; // –≤ –º–µ—Ç—Ä–∞—Ö
                        window.NavesCalc.params.postFootDepth = (height + footOverhang * 2) / 1000; // –≤ –º–µ—Ç—Ä–∞—Ö
                        window.NavesCalc.params.postFootHeight = footThickness / 1000; // –≤ –º–µ—Ç—Ä–∞—Ö
                        console.log(`–ü–æ–¥–ø—è—Ç–Ω–∏–∫ —Å—Ç–æ–ª–±–∞ ${postType}: ${width + footOverhang * 2}x${height + footOverhang * 2}x${footThickness} –º–º`);
                    }
                    
                    if (postType === 'var-3' || postType === 'var-4') {
                        window.NavesCalc.params.postCapitalWidth = (width + capitalOverhang * 2) / 1000; // –≤ –º–µ—Ç—Ä–∞—Ö
                        window.NavesCalc.params.postCapitalDepth = (height + capitalOverhang * 2) / 1000; // –≤ –º–µ—Ç—Ä–∞—Ö
                        window.NavesCalc.params.postCapitalHeight = capitalThickness / 1000; // –≤ –º–µ—Ç—Ä–∞—Ö
                        console.log(`–ö–∞–ø–∏—Ç–µ–ª—å —Å—Ç–æ–ª–±–∞ ${postType}: ${width + capitalOverhang * 2}x${height + capitalOverhang * 2}x${capitalThickness} –º–º`);
                    }
                    
                    console.log(`–°–µ—á–µ–Ω–∏–µ —Å—Ç–æ–ª–±–∞ ${postType}: ${width}x${height} –º–º`);
                }
            }
        }
        
        function initRadioButtons() {
            console.log('=== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –†–ê–î–ò–û–ö–ù–û–ü–û–ö ===');
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Ä–∞–¥–∏–æ–∫–Ω–æ–ø–æ–∫ –≤—ã–±–æ—Ä–∞ —Å—Ç–æ–ª–±–æ–≤
            const stolbiRadios = document.querySelectorAll('input[name="type-stolbi"]');
            
            console.log('–ù–∞–π–¥–µ–Ω–æ —Ä–∞–¥–∏–æ–∫–Ω–æ–ø–æ–∫ —Å—Ç–æ–ª–±–æ–≤:', stolbiRadios.length);
            
            stolbiRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    if (this.checked && window.NavesCalc) {
                        window.NavesCalc.params.postType = this.value;
                        console.log('–í—ã–±—Ä–∞–Ω —Ç–∏–ø —Å—Ç–æ–ª–±–∞:', this.value);
                        updatePostThickness(); // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—â–∏–Ω—É —Å—Ç–æ–ª–±–∞
                        window.NavesCalc.update3DModel();
                        window.NavesCalc.calculateTotal();
                        window.NavesCalc.updateSpecification();
                    }
                });
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Ä–∞–¥–∏–æ–∫–Ω–æ–ø–æ–∫ –≤—ã–±–æ—Ä–∞ —Ä–∞—Å–∫–æ—Å–æ–≤
            const raskosiRadios = document.querySelectorAll('input[name="type-raskosi"]');
            
            console.log('–ù–∞–π–¥–µ–Ω–æ —Ä–∞–¥–∏–æ–∫–Ω–æ–ø–æ–∫ —Ä–∞—Å–∫–æ—Å–æ–≤:', raskosiRadios.length);
            
            raskosiRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    if (this.checked && window.NavesCalc) {
                        window.NavesCalc.params.braceType = this.id.replace('type-raskosi-var-', 'var-');
                        window.NavesCalc.update3DModel();
                        window.NavesCalc.calculateTotal();
                        window.NavesCalc.updateSpecification();
                    }
                });
            });
        }
        
        function syncDefaultValues() {
            // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å HTML —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏
            if (window.NavesCalc) {
                const params = window.NavesCalc.params;
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Å–µ–ª–µ–∫—Ç–æ–≤
                const frameMaterialSelect = document.getElementById('frameMaterial');
                if (frameMaterialSelect) {
                    frameMaterialSelect.value = params.frameMaterial || 'pine';
                }
                
                const postMaterialSelect = document.getElementById('postMaterial');
                if (postMaterialSelect) {
                    postMaterialSelect.value = params.postMaterial || 'glued-150x150';
                }
                
                const trussMaterialSelect = document.getElementById('trussMaterial');
                if (trussMaterialSelect) {
                    trussMaterialSelect.value = params.trussMaterial || 'planed-45x190';
                }
                
                const braceTypeSelect = document.getElementById('braceType');
                if (braceTypeSelect) {
                    braceTypeSelect.value = params.braceType || 'var-1';
                }
                
                const frameColoringSelect = document.getElementById('frameColoring');
                if (frameColoringSelect) {
                    frameColoringSelect.value = params.frameColoring || 'no-coloring';
                }
                
                const roofingMaterialSelect = document.getElementById('roofingMaterial');
                if (roofingMaterialSelect) {
                    roofingMaterialSelect.value = params.roofingMaterial || 'metal-grandline';
                }
                
                const roofColorSelect = document.getElementById('roofColor');
                if (roofColorSelect) {
                    roofColorSelect.value = params.roofColor || 'amber';
                }
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Å–ª–∞–π–¥–µ—Ä–æ–≤
                const columnStepSlider = document.getElementById('columnStep');
                if (columnStepSlider) {
                    columnStepSlider.value = (params.postSpacing || 25) * 10; // –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ –¥–µ—Ü–∏–º–µ—Ç—Ä—ã
                    const valueSpan = columnStepSlider.closest('.has-slider').querySelector('.value span');
                    if (valueSpan) {
                        valueSpan.textContent = (params.postSpacing || 25) / 10;
                    }
                }
                
                const frontBeamExtensionSlider = document.getElementById('frontBeamExtension');
                if (frontBeamExtensionSlider) {
                    frontBeamExtensionSlider.value = params.frontBeamExtension || 200;
                    const valueSpan = frontBeamExtensionSlider.closest('.has-slider').querySelector('.value span');
                    if (valueSpan) {
                        valueSpan.textContent = params.frontBeamExtension || 200;
                    }
                }
                
                const backBeamExtensionSlider = document.getElementById('backBeamExtension');
                if (backBeamExtensionSlider) {
                    backBeamExtensionSlider.value = params.backBeamExtension || 200;
                    const valueSpan = backBeamExtensionSlider.closest('.has-slider').querySelector('.value span');
                    if (valueSpan) {
                        valueSpan.textContent = params.backBeamExtension || 200;
                    }
                }
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∏–ø —Å—Ç–æ–ª–±–∞
                const postType = params.postType || 'var-5';
                const postRadio = document.getElementById(`type-stolbi-${postType}`);
                if (postRadio) {
                    postRadio.checked = true;
                }
            }
        }
        
        function initCameraControls() {
            // –ö–Ω–æ–ø–∫–∞ —Å–±—Ä–æ—Å–∞ –∫–∞–º–µ—Ä—ã
            const resetBtn = document.getElementById('reset-camera');
            if (resetBtn) {
                resetBtn.addEventListener('click', () => {
                    if (window.NavesCalc && window.NavesCalc.controls) {
                        window.NavesCalc.controls.reset();
                        window.NavesCalc.needsRender = true;
                    }
                });
            }
            
            // –ö–Ω–æ–ø–∫–∞ –≤–∏–¥–∞ —Å–≤–µ—Ä—Ö—É
            const topViewBtn = document.getElementById('top-view');
            if (topViewBtn) {
                topViewBtn.addEventListener('click', () => {
                    if (window.NavesCalc && window.NavesCalc.camera && window.NavesCalc.controls) {
                        window.NavesCalc.camera.position.set(0, 20, 0);
                        window.NavesCalc.controls.target.set(0, 0, 0);
                        window.NavesCalc.controls.update();
                        window.NavesCalc.needsRender = true;
                    }
                });
            }
            
            // –ö–Ω–æ–ø–∫–∞ –≤–∏–¥–∞ —Å–ø–µ—Ä–µ–¥–∏
            const frontViewBtn = document.getElementById('front-view');
            if (frontViewBtn) {
                frontViewBtn.addEventListener('click', () => {
                    if (window.NavesCalc && window.NavesCalc.camera && window.NavesCalc.controls) {
                        window.NavesCalc.camera.position.set(0, 5, 15);
                        window.NavesCalc.controls.target.set(0, 2, 0);
                        window.NavesCalc.controls.update();
                        window.NavesCalc.needsRender = true;
                    }
                });
            }
            
            // –ö–Ω–æ–ø–∫–∞ –≤–∏–¥–∞ —Å–±–æ–∫—É
            const sideViewBtn = document.getElementById('side-view');
            if (sideViewBtn) {
                sideViewBtn.addEventListener('click', () => {
                    if (window.NavesCalc && window.NavesCalc.camera && window.NavesCalc.controls) {
                        window.NavesCalc.camera.position.set(15, 5, 0);
                        window.NavesCalc.controls.target.set(0, 2, 0);
                        window.NavesCalc.controls.update();
                        window.NavesCalc.needsRender = true;
                    }
                });
            }
        }
        
        // ‚ö†Ô∏è DEPRECATED: –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
        // –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–∫–∞–∑–∞, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ MVP –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
        // –∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ app.js —á–µ—Ä–µ–∑ window.makeOrder(), window.saveCalculation(), window.exportToPDF()
        function initOrderFunctions_DEPRECATED() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
            const storageManager = new StorageManager();
            const orderManager = new OrderManager('/api/orders'); // –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—É—Ç—å –∫ –≤–∞—à–µ–º—É API
            const pdfExporter = new PDFExporter();
            
            // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–∞
            function getCurrentCalculationData() {
                const params = window.NavesCalc ? window.NavesCalc.params : {};
                const totalPrice = document.getElementById('totalPrice')?.textContent || '0 ‚ÇΩ';
                
                return {
                    // –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
                    length: params.length ? params.length / 10 : 0, // –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ –º–µ—Ç—Ä—ã
                    width: params.width ? params.width / 10 : 0,
                    height: params.height ? params.height / 10 : 0,
                    roofHeight: params.roofHeight ? params.roofHeight / 10 : 0,
                    area: params.length && params.width ? (params.length * params.width / 100).toFixed(2) : 0,
                    
                    // –¢–∏–ø—ã –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
                    roofType: params.roofType || 'var-2',
                    postType: params.postType || 'var-5',
                    braceType: params.braceType || 'var-1',
                    postMaterial: params.postMaterial || 'glued-150x150',
                    trussMaterial: params.trussMaterial || 'planed-45x190',
                    roofingMaterial: params.roofingMaterial || 'metal-grandline',
                    roofColor: params.roofColor || 'amber',
                    frameMaterial: params.frameMaterial || 'pine',
                    frameColoring: params.frameColoring || 'no-coloring',
                    
                    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ
                    postSpacing: params.postSpacing ? params.postSpacing / 10 : 2.5,
                    frontBeamExtension: params.frontBeamExtension || 200,
                    backBeamExtension: params.backBeamExtension || 200,
                    mountingRequired: params.mountingRequired || 'yes',
                    distanceFromMKAD: params.distanceFromMKAD || 10,
                    
                    // –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å
                    totalPrice: totalPrice,
                    timestamp: Date.now(),
                    date: new Date().toLocaleString('ru-RU')
                };
            }
            
            // –§—É–Ω–∫—Ü–∏—è –∑–∞–∫–∞–∑–∞
            window.makeOrder = function() {
                try {
                    const calculationData = getCurrentCalculationData();
                    const orderForm = orderManager.createOrderForm(calculationData);
                    document.body.appendChild(orderForm);
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ñ–æ—Ä–º—ã –∑–∞–∫–∞–∑–∞:', error);
                    alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Ñ–æ—Ä–º—ã –∑–∞–∫–∞–∑–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
                }
            };
            
            // –§—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–∞—Å—á–µ—Ç–∞
            window.saveCalculation = function() {
                try {
                    const calculationData = getCurrentCalculationData();
                    
                    // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞
                    const name = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞:', `–ù–∞–≤–µ—Å ${calculationData.length}√ó${calculationData.width}–º`);
                    
                    if (name !== null) { // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–∂–∞–ª "–û—Ç–º–µ–Ω–∞"
                        const calcId = storageManager.saveCalculation(calculationData, name || undefined);
                        
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
                        showNotification('‚úÖ –†–∞—Å—á–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω!', 'success');
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∏—Å—Ç–æ—Ä–∏–∏, –µ—Å–ª–∏ –ø–∞–Ω–µ–ª—å –æ—Ç–∫—Ä—ã—Ç–∞
                        updateHistoryPanel();
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ä–∞—Å—á–µ—Ç–∞:', error);
                    showNotification('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ä–∞—Å—á–µ—Ç–∞', 'error');
                }
            };
            
            // –§—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ PDF
            window.exportToPDF = function() {
                try {
                    const calculationData = getCurrentCalculationData();
                    const filename = `naves_${calculationData.length}x${calculationData.width}m_${Date.now()}.pdf`;
                    
                    showNotification('‚è≥ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF...', 'info');
                    
                    pdfExporter.exportToPDF(calculationData, filename).then(() => {
                        showNotification('‚úÖ PDF —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!', 'success');
                    }).catch((error) => {
                        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ PDF:', error);
                        showNotification('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PDF', 'error');
                    });
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ PDF:', error);
                    showNotification('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ PDF', 'error');
                }
            };
            
            // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞
            window.loadSavedCalculation = function(calcId) {
                try {
                    const calculationData = storageManager.loadCalculation(calcId);
                    
                    if (calculationData && window.NavesCalc) {
                        // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
                        const params = calculationData;
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
                        if (params.length) window.NavesCalc.updateParam('length', params.length * 10); // –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –æ–±—Ä–∞—Ç–Ω–æ –≤ –¥–µ—Ü–∏–º–µ—Ç—Ä—ã
                        if (params.width) window.NavesCalc.updateParam('width', params.width * 10);
                        if (params.height) window.NavesCalc.updateParam('height', params.height * 10);
                        if (params.roofHeight) window.NavesCalc.updateParam('roofHeight', params.roofHeight * 10);
                        if (params.roofType) window.NavesCalc.updateParam('roofType', params.roofType);
                        if (params.postType) window.NavesCalc.updateParam('postType', params.postType);
                        if (params.braceType) window.NavesCalc.updateParam('braceType', params.braceType);
                        if (params.postMaterial) window.NavesCalc.updateParam('postMaterial', params.postMaterial);
                        if (params.trussMaterial) window.NavesCalc.updateParam('trussMaterial', params.trussMaterial);
                        if (params.roofingMaterial) window.NavesCalc.updateParam('roofingMaterial', params.roofingMaterial);
                        if (params.roofColor) window.NavesCalc.updateParam('roofColor', params.roofColor);
                        
                        showNotification('‚úÖ –†–∞—Å—á–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω!', 'success');
                    } else {
                        showNotification('‚ùå –†–∞—Å—á–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ä–∞—Å—á–µ—Ç–∞:', error);
                    showNotification('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ä–∞—Å—á–µ—Ç–∞', 'error');
                }
            };
            
            // –§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è —Ä–∞—Å—á–µ—Ç–∞
            window.deleteSavedCalculation = function(calcId) {
                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ä–∞—Å—á–µ—Ç?')) {
                    try {
                        storageManager.deleteCalculation(calcId);
                        updateHistoryPanel();
                        showNotification('‚úÖ –†–∞—Å—á–µ—Ç —É–¥–∞–ª–µ–Ω', 'success');
                    } catch (error) {
                        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ä–∞—Å—á–µ—Ç–∞:', error);
                        showNotification('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏', 'error');
                    }
                }
            };
            
            // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞–Ω–µ–ª–∏ –∏—Å—Ç–æ—Ä–∏–∏
            window.updateHistoryPanel = function() {
                const historyPanel = document.getElementById('history-panel');
                if (!historyPanel) return;
                
                const calculations = storageManager.getAllCalculations();
                const historyList = historyPanel.querySelector('.history-list');
                
                if (!historyList) return;
                
                if (calculations.length === 0) {
                    historyList.innerHTML = '<p style="text-align: center; color: #999;">–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤</p>';
                    return;
                }
                
                historyList.innerHTML = calculations.map(calc => `
                    <div class="history-item" data-id="${calc.id}">
                        <div class="history-item-header">
                            <strong>${calc.name}</strong>
                            <span class="history-item-date">${new Date(calc.timestamp).toLocaleString('ru-RU')}</span>
                        </div>
                        <div class="history-item-details">
                            ${calc.data.length}√ó${calc.data.width}–º, ${calc.data.totalPrice}
                        </div>
                        <div class="history-item-actions">
                            <button onclick="loadSavedCalculation('${calc.id}')" class="btn-small btn-primary">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                            <button onclick="deleteSavedCalculation('${calc.id}')" class="btn-small btn-danger">–£–¥–∞–ª–∏—Ç—å</button>
                        </div>
                    </div>
                `).join('');
            };
            
            // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
            function showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.className = `notification notification-${type}`;
                notification.textContent = message;
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    padding: 15px 25px;
                    background: ${type === 'success' ? '#4CAF50' : type === 'error' ? '#f44336' : '#2196F3'};
                    color: white;
                    border-radius: 8px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                    z-index: 10000;
                    font-size: 14px;
                    animation: slideIn 0.3s ease;
                `;
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => notification.remove(), 300);
                }, 3000);
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
            if (!document.getElementById('notification-styles')) {
                const style = document.createElement('style');
                style.id = 'notification-styles';
                style.textContent = `
                    @keyframes slideIn {
                        from { transform: translateX(400px); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }
                    @keyframes slideOut {
                        from { transform: translateX(0); opacity: 1; }
                        to { transform: translateX(400px); opacity: 0; }
                    }
                    .history-item {
                        padding: 15px;
                        margin-bottom: 10px;
                        background: #f5f5f5;
                        border-radius: 8px;
                        border-left: 4px solid #20B5B9;
                    }
                    .history-item-header {
                        display: flex;
                        justify-content: space-between;
                        margin-bottom: 8px;
                    }
                    .history-item-date {
                        color: #999;
                        font-size: 12px;
                    }
                    .history-item-details {
                        color: #666;
                        font-size: 14px;
                        margin-bottom: 10px;
                    }
                    .history-item-actions {
                        display: flex;
                        gap: 10px;
                    }
                    .btn-small {
                        padding: 6px 12px;
                        font-size: 12px;
                        border: none;
                        border-radius: 4px;
                        cursor: pointer;
                    }
                    .btn-primary {
                        background: #20B5B9;
                        color: white;
                    }
                    .btn-danger {
                        background: #f44336;
                        color: white;
                    }
                `;
                document.head.appendChild(style);
            }
            
            // –§—É–Ω–∫—Ü–∏—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è 3D –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            window.download3DImage = function() {
                if (window.NavesCalc && window.NavesCalc.renderer) {
                    // –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
                    const canvas = window.NavesCalc.renderer.domElement;
                    const link = document.createElement('a');
                    link.download = 'naves-3d-model.png';
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                } else {
                    alert('3D –º–æ–¥–µ–ª—å –Ω–µ –≥–æ—Ç–æ–≤–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è');
                }
            };
        }
        
        
        // –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –º–µ–Ω–µ–¥–∂–µ—Ä—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
        window.PerformanceOptimizer = PerformanceOptimizer;
        
        // –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –î–õ–Ø –û–¢–õ–ê–î–û–ß–ù–´–• –ö–ù–û–ü–û–ö
        function initDebugButtons() {
            console.log('=== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –û–¢–õ–ê–î–û–ß–ù–´–• –ö–ù–û–ü–û–ö ===');
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –æ—Ç–ª–∞–¥–æ—á–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫ –≤—ã–±–æ—Ä–∞ —Å—Ç–æ–ª–±–æ–≤
            const debugStolbiRadios = document.querySelectorAll('input[name="type-stolbi"]');
            
            console.log('–ù–∞–π–¥–µ–Ω–æ –æ—Ç–ª–∞–¥–æ—á–Ω—ã—Ö —Ä–∞–¥–∏–æ–∫–Ω–æ–ø–æ–∫ —Å—Ç–æ–ª–±–æ–≤:', debugStolbiRadios.length);
            
            debugStolbiRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    if (this.checked && window.NavesCalc) {
                        window.NavesCalc.params.postType = this.value;
                        console.log('–í—ã–±—Ä–∞–Ω —Ç–∏–ø —Å—Ç–æ–ª–±–∞ (–æ—Ç–ª–∞–¥–∫–∞):', this.value);
                        updatePostThickness(); // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—â–∏–Ω—É —Å—Ç–æ–ª–±–∞
                        window.NavesCalc.update3DModel();
                        window.NavesCalc.calculateTotal();
                        updateDebugInfo(); // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
                    }
                });
            });
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
        function updateDebugInfo() {
            if (window.NavesCalc && window.NavesCalc.params) {
                const price = window.NavesCalc.calculateTotal();
                const dimensions = `${window.NavesCalc.params.length}x${window.NavesCalc.params.width} –º`;
                const height = `${window.NavesCalc.params.height} –º`;
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–∞–∑–º–µ—Ä –ø—Ä–æ–¥–æ–ª—å–Ω—ã—Ö –±–∞–ª–æ–∫ (–º–∞—É—ç—Ä–ª–∞—Ç–æ–≤) –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —Å—Ç–æ–ª–±–∞
                const postType = window.NavesCalc.params.postType;
                let longitudinalBeamSize;
                if (postType === 'var-1' || postType === 'var-5') {
                    longitudinalBeamSize = '200√ó200 –º–º';
                } else {
                    // –î–ª—è var-2, var-3, var-4 –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–µ—á–µ–Ω–∏–µ —Å—Ç–æ–ª–±–æ–≤
                    const postMaterial = window.NavesCalc.params.postMaterial;
                    const match = postMaterial.match(/(\d+)x(\d+)/);
                    if (match) {
                        longitudinalBeamSize = `${match[1]}√ó${match[2]} –º–º`;
                    } else {
                        longitudinalBeamSize = '150√ó150 –º–º';
                    }
                }
                
                const priceEl = document.getElementById('debug-total-price');
                const dimensionsEl = document.getElementById('debug-dimensions');
                const heightEl = document.getElementById('debug-height');
                const longitudinalBeamEl = document.getElementById('debug-longitudinal-beam');
                
                if (priceEl) priceEl.textContent = price.toLocaleString() + ' ‚ÇΩ';
                if (dimensionsEl) dimensionsEl.textContent = dimensions;
                if (heightEl) heightEl.textContent = height;
                if (longitudinalBeamEl) longitudinalBeamEl.textContent = longitudinalBeamSize;
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –≤—ã–±–æ—Ä–∞ —Å–µ—á–µ–Ω–∏—è –±–∞–ª–æ–∫
        window.selectBeam = function(element, value) {
            console.log('üî® –í—ã–±–æ—Ä —Å–µ—á–µ–Ω–∏—è –±–∞–ª–æ–∫:', value);
            
            // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            const allBeamItems = document.querySelectorAll('.debug-beam-item');
            allBeamItems.forEach(item => item.classList.remove('selected'));
            
            // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
            element.classList.add('selected');
            
            // –û—Ç–º–µ—á–∞–µ–º radio –∫–Ω–æ–ø–∫—É
            const radio = element.querySelector('input[type="radio"]');
            if (radio) {
                radio.checked = true;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ MVP Presenter (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±)
            if (window.CanopyApp && window.CanopyApp.presenter) {
                console.log('‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ CanopyApp.presenter');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —á–µ—Ä–µ–∑ Presenter - —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç Model, View –∏ Renderer
                window.CanopyApp.presenter.onViewParamChanged('trussMaterial', value);
                
                console.log('–¢–µ–∫—É—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:', window.CanopyApp.model.params);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–º –±–ª–æ–∫–µ
                const beamSectionEl = document.getElementById('debug-beam-section');
                const sizeText = element.querySelector('.debug-beam-size').textContent;
                if (beamSectionEl) {
                    beamSectionEl.textContent = sizeText;
                }
                
                // –¢–∞–∫–∂–µ –æ–±–Ω–æ–≤–ª—è–µ–º —Å–∫—Ä—ã—Ç—ã–π —Å–µ–ª–µ–∫—Ç –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
                const trussMaterialSelect = document.getElementById('trussMaterial');
                if (trussMaterialSelect) {
                    trussMaterialSelect.value = value;
                }
                
                console.log('‚úÖ –°–µ—á–µ–Ω–∏–µ –±–∞–ª–æ–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–æ —á–µ—Ä–µ–∑ MVP');
            } else {
                console.error('‚ùå CanopyApp.presenter –Ω–µ –Ω–∞–π–¥–µ–Ω');
            }
            
            console.log('–í—ã–±—Ä–∞–Ω–æ —Å–µ—á–µ–Ω–∏–µ –±–∞–ª–æ–∫ (trussMaterial):', value);
        };
        
        // –§—É–Ω–∫—Ü–∏—è –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ —Ñ–µ—Ä–º (—Ñ–æ—Ä–º–∞ –∫—Ä–æ–≤–ª–∏)
        window.selectTrussType = function(element, value) {
            console.log('üèóÔ∏è –í—ã–±–æ—Ä —Ç–∏–ø–∞ —Ñ–µ—Ä–º:', value);
            
            // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            const allTrussItems = document.querySelectorAll('.debug-truss-item');
            allTrussItems.forEach(item => {
                item.style.border = '2px solid #ddd';
                item.style.background = 'transparent';
            });
            
            // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
            element.style.border = '2px solid #20B5B9';
            element.style.background = '#f0fbfb';
            
            // –û—Ç–º–µ—á–∞–µ–º radio –∫–Ω–æ–ø–∫—É
            const radio = element.querySelector('input[type="radio"]');
            if (radio) {
                radio.checked = true;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ MVP Presenter (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±)
            if (window.CanopyApp && window.CanopyApp.presenter) {
                console.log('‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ CanopyApp.presenter');
                
                // –í–ê–ñ–ù–û: –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è roofType, –Ω–µ trussType!
                window.CanopyApp.presenter.onViewParamChanged('roofType', value);
                
                console.log('–¢–µ–∫—É—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:', window.CanopyApp.model.params);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Å–µ —Ä–∞–¥–∏–æ–∫–Ω–æ–ø–∫–∏ —Ç–∏–ø–∞ —Ñ–µ—Ä–º
                const trussTypeRadios = document.querySelectorAll('input[name="type-karkas"]');
                trussTypeRadios.forEach(radio => {
                    if (radio.value === value) {
                        radio.checked = true;
                    }
                });
                
                // –¢–∞–∫–∂–µ –æ–±–Ω–æ–≤–ª—è–µ–º —Ä–∞–¥–∏–æ–∫–Ω–æ–ø–∫–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ MVP
                const mvpRoofRadios = document.querySelectorAll('.nc-radio__input[name="type-karkas"]');
                mvpRoofRadios.forEach(radio => {
                    if (radio.value === value) {
                        radio.checked = true;
                    }
                });
                
                console.log('‚úÖ –¢–∏–ø —Ñ–µ—Ä–º –æ–±–Ω–æ–≤–ª–µ–Ω —á–µ—Ä–µ–∑ MVP');
            } else {
                console.error('‚ùå CanopyApp.presenter –Ω–µ –Ω–∞–π–¥–µ–Ω');
            }
            
            console.log('–í—ã–±—Ä–∞–Ω —Ç–∏–ø —Ñ–µ—Ä–º (roofType):', value);
        };
        
        // –§—É–Ω–∫—Ü–∏—è –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ —Ä–∞—Å–∫–æ—Å–æ–≤
        window.selectBraceType = function(element, value) {
            console.log('üîß –í—ã–±–æ—Ä —Ä–∞—Å–∫–æ—Å–∞:', value);
            
            // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            const allBraceItems = document.querySelectorAll('.debug-brace-item');
            allBraceItems.forEach(item => {
                item.style.border = '2px solid #ddd';
                item.style.background = 'transparent';
            });
            
            // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
            element.style.border = '2px solid #20B5B9';
            element.style.background = '#f0fbfb';
            
            // –û—Ç–º–µ—á–∞–µ–º radio –∫–Ω–æ–ø–∫—É
            const radio = element.querySelector('input[type="radio"]');
            if (radio) {
                radio.checked = true;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ MVP Presenter (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±)
            if (window.CanopyApp && window.CanopyApp.presenter) {
                console.log('‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ CanopyApp.presenter');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —á–µ—Ä–µ–∑ Presenter - —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç Model, View –∏ Renderer
                window.CanopyApp.presenter.onViewParamChanged('braceType', value);
                
                console.log('–¢–µ–∫—É—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:', window.CanopyApp.model.params);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Å–µ —Ä–∞–¥–∏–æ–∫–Ω–æ–ø–∫–∏ —Ç–∏–ø–∞ —Ä–∞—Å–∫–æ—Å–æ–≤
                const braceTypeRadios = document.querySelectorAll('input[name="type-raskosi"]');
                braceTypeRadios.forEach(radio => {
                    if (radio.value === value || radio.id.includes(value)) {
                        radio.checked = true;
                    }
                });
                
                // –¢–∞–∫–∂–µ –æ–±–Ω–æ–≤–ª—è–µ–º —Ä–∞–¥–∏–æ–∫–Ω–æ–ø–∫–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ MVP
                const mvpBraceRadios = document.querySelectorAll('.nc-brace__input');
                mvpBraceRadios.forEach(radio => {
                    if (radio.value === value) {
                        radio.checked = true;
                        // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –≤ MVP –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
                        const label = radio.nextElementSibling;
                        if (label) {
                            const allLabels = document.querySelectorAll('.nc-brace-item label');
                            allLabels.forEach(l => {
                                l.style.borderColor = '#e2e8f0';
                                l.style.background = '#f7fafc';
                            });
                            label.style.borderColor = '#20B5B9';
                            label.style.background = 'rgba(32, 181, 185, 0.1)';
                        }
                    }
                });
                
                console.log('‚úÖ –†–∞—Å–∫–æ—Å –æ–±–Ω–æ–≤–ª–µ–Ω —á–µ—Ä–µ–∑ MVP');
            } else {
                console.error('‚ùå CanopyApp.presenter –Ω–µ –Ω–∞–π–¥–µ–Ω');
            }
            
            console.log('–í—ã–±—Ä–∞–Ω —Ç–∏–ø —Ä–∞—Å–∫–æ—Å–æ–≤:', value);
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã–±–æ—Ä–∞ –±–∞–ª–æ–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        function initBeamSelection() {
            const defaultBeamItem = document.querySelector('.debug-beam-item input[checked]');
            if (defaultBeamItem) {
                const parent = defaultBeamItem.closest('.debug-beam-item');
                if (parent) {
                    parent.classList.add('selected');
                }
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã–±–æ—Ä–∞ —Ä–∞—Å–∫–æ—Å–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        function initBraceSelection() {
            console.log('üîß –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã–±–æ—Ä–∞ —Ä–∞—Å–∫–æ—Å–æ–≤...');
            
            // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π —Ç–∏–ø —Ä–∞—Å–∫–æ—Å–∞ –∏–∑ NavesCalc
            let currentBraceType = 'var-1'; // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            if (window.NavesCalc && window.NavesCalc.params && window.NavesCalc.params.braceType) {
                currentBraceType = window.NavesCalc.params.braceType;
            }
            
            console.log('–¢–µ–∫—É—â–∏–π —Ç–∏–ø —Ä–∞—Å–∫–æ—Å–∞:', currentBraceType);
            
            // –í—ã–¥–µ–ª—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç –≤ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
            const allBraceItems = document.querySelectorAll('.debug-brace-item');
            allBraceItems.forEach(item => {
                const radio = item.querySelector('input[type="radio"]');
                if (radio && radio.value === currentBraceType) {
                    item.style.border = '2px solid #20B5B9';
                    item.style.background = '#f0fbfb';
                    radio.checked = true;
                    console.log('‚úÖ –í—ã–¥–µ–ª–µ–Ω —Ä–∞—Å–∫–æ—Å:', currentBraceType);
                } else {
                    item.style.border = '2px solid #ddd';
                    item.style.background = 'transparent';
                }
            });
        }
        
        // –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ë–ï–ì–£–ù–ö–û–í (–ü–ê–†–ê–ú–ï–¢–†–´ –ö–û–ù–°–¢–†–£–ö–¶–ò–ò)
        function updateLength(value) {
            const meters = value / 10;
            document.getElementById('length-value').textContent = meters.toFixed(1) + ' –º';
            if (window.NavesCalc) {
                window.NavesCalc.params.length = parseInt(value);
                window.NavesCalc.update3DModel();
                window.NavesCalc.calculateTotal();
                updateDebugInfo();
            }
        }
        
        function updateWidth(value) {
            const meters = value / 10;
            document.getElementById('width-value').textContent = meters.toFixed(1) + ' –º';
            if (window.NavesCalc) {
                window.NavesCalc.params.width = parseInt(value);
                window.NavesCalc.update3DModel();
                window.NavesCalc.calculateTotal();
                updateDebugInfo();
            }
        }
        
        function updateHeight(value) {
            const meters = value / 10;
            document.getElementById('height-value').textContent = meters.toFixed(1) + ' –º';
            if (window.NavesCalc) {
                window.NavesCalc.params.height = parseInt(value);
                window.NavesCalc.update3DModel();
                window.NavesCalc.calculateTotal();
                updateDebugInfo();
            }
        }
        
        function updateRoofHeight(value) {
            const meters = value / 10;
            document.getElementById('roof-height-value').textContent = meters.toFixed(1) + ' –º';
            if (window.NavesCalc) {
                window.NavesCalc.params.roofHeight = parseInt(value);
                window.NavesCalc.update3DModel();
                window.NavesCalc.calculateTotal();
                updateDebugInfo();
            }
        }
        
        function updatePostSpacing(value) {
            const meters = value / 10;
            document.getElementById('post-spacing-value').textContent = meters.toFixed(1) + ' –º';
            if (window.NavesCalc) {
                window.NavesCalc.params.postSpacing = parseInt(value);
                window.NavesCalc.update3DModel();
                window.NavesCalc.calculateTotal();
                updateDebugInfo();
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ —Ñ–µ—Ä–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        function initTrussSelection() {
            const defaultTrussItem = document.querySelector('.debug-truss-item input[checked]');
            if (defaultTrussItem) {
                const parent = defaultTrussItem.closest('.debug-truss-item');
                if (parent) {
                    parent.style.border = '2px solid #20B5B9';
                    parent.style.background = '#f0fbfb';
                }
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–ª–∞–¥–æ—á–Ω–æ–≥–æ 3D –æ–∫–Ω–∞
        function initDebug3D() {
            console.log('üîß –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–ª–∞–¥–æ—á–Ω–æ–≥–æ 3D –æ–∫–Ω–∞...');
            
            if (!window.CanopyApp || !window.CanopyApp.renderer) {
                console.error('‚ùå CanopyApp –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }
            
            const debugCanvas = document.getElementById('debug-canvas');
            if (!debugCanvas) {
                console.error('‚ùå Debug canvas –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }
            
            try {
                // –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞–µ–º —Ä–µ–Ω–¥–µ—Ä–µ—Ä –∫ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–º—É canvas
                const renderer = window.CanopyApp.renderer;
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ —Å—Ç–∞—Ä—ã–π canvas
                const oldCanvas = renderer.canvasElement;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º canvas —ç–ª–µ–º–µ–Ω—Ç
                renderer.canvasElement = debugCanvas;
                
                // –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞–µ–º WebGL —Ä–µ–Ω–¥–µ—Ä–µ—Ä
                if (renderer.renderer) {
                    const container = debugCanvas.parentElement;
                    container.removeChild(debugCanvas);
                    
                    // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π DOM —ç–ª–µ–º–µ–Ω—Ç —Ä–µ–Ω–¥–µ—Ä–µ—Ä–∞
                    const oldRendererElement = renderer.renderer.domElement;
                    if (oldRendererElement && oldRendererElement.parentElement) {
                        oldRendererElement.parentElement.removeChild(oldRendererElement);
                    }
                    
                    // –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ–º –Ω–æ–≤—ã–π canvas
                    container.appendChild(renderer.renderer.domElement);
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–∞–∑–º–µ—Ä—ã
                    const rect = container.getBoundingClientRect();
                    renderer.renderer.setSize(rect.width, rect.height);
                    renderer.camera.aspect = rect.width / rect.height;
                    renderer.camera.updateProjectionMatrix();
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ç—Ä–æ–ª–ª—ã
                    if (renderer.controls) {
                        renderer.controls.update();
                    }
                    
                    // –ü–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–≤–∞–µ–º —Å—Ü–µ–Ω—É
                    renderer.renderer.render(renderer.scene, renderer.camera);
                    
                    console.log('‚úÖ –û—Ç–ª–∞–¥–æ—á–Ω–æ–µ 3D –æ–∫–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ');
                } else {
                    console.error('‚ùå –†–µ–Ω–¥–µ—Ä–µ—Ä –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                }
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–≥–æ 3D:', error);
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–ª–∞–¥–æ—á–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
        // –û–¢–õ–ê–î–û–ß–ù–´–ô –†–ï–ñ–ò–ú –û–¢–ö–õ–Æ–ß–Å–ù
        // –ß—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å –æ—Ç–ª–∞–¥–∫—É - —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∫–æ–¥ –Ω–∏–∂–µ:
        // document.addEventListener('DOMContentLoaded', function() {
        //     setTimeout(initDebug3D, 500);         // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è 3D –æ–∫–Ω–∞
        //     setTimeout(initDebugButtons, 1000);
        //     setTimeout(initBeamSelection, 1100);
        //     setTimeout(initTrussSelection, 1150);
        //     setTimeout(initBraceSelection, 1180); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã–±–æ—Ä–∞ —Ä–∞—Å–∫–æ—Å–æ–≤
        //     setTimeout(updateDebugInfo, 1200);    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –±–ª–æ–∫
        // });
    </script>
    
</body>
</html>


