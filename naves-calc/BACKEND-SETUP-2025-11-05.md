# üîå Backend –Ω–∞—Å—Ç—Ä–æ–µ–Ω!

**–î–∞—Ç–∞:** 05.11.2025  
**–í–µ—Ä—Å–∏—è:** 1.0

---

## ‚úÖ –ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ

### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ backend:

```
naves-calc/api/
‚îú‚îÄ‚îÄ orders.php              ‚Üê PHP endpoint (–≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é)
‚îú‚îÄ‚îÄ config.example.php      ‚Üê –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ server.js               ‚Üê Node.js —Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ config.json             ‚Üê –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Node.js
‚îú‚îÄ‚îÄ package.json            ‚Üê –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Node.js
‚îú‚îÄ‚îÄ README.md               ‚Üê –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ orders/
    ‚îî‚îÄ‚îÄ .htaccess           ‚Üê –ó–∞—â–∏—Ç–∞ —Ñ–∞–π–ª–æ–≤ –∑–∞–∫–∞–∑–æ–≤
```

---

## üöÄ –î–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –Ω–∞ –≤—ã–±–æ—Ä

### –í–∞—Ä–∏–∞–Ω—Ç 1: PHP (–ü—Ä–æ—â–µ)
‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π  
‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ª—é–±–æ–º —Ö–æ—Å—Ç–∏–Ω–≥–µ  
‚úÖ –ì–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å—Ä–∞–∑—É  

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- PHP 7.4+
- –í–µ–±-—Å–µ—Ä–≤–µ—Ä (Apache/Nginx)

**–ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å:**
1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–∞–ø–∫—É `api/` –Ω–∞ —Å–µ—Ä–≤–µ—Ä
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∞–≤–∞: `chmod 777 api/orders/`
3. –í `index.html` —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—É—Ç—å: `/naves-calc/api/orders.php`
4. –ì–æ—Ç–æ–≤–æ!

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: Node.js (–ú–æ—â–Ω–µ–µ)
‚úÖ –ë–æ–ª—å—à–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π  
‚úÖ –õ—É—á—à–µ –¥–ª—è –≤—ã—Å–æ–∫–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫  
‚úÖ REST API –∏–∑ –∫–æ—Ä–æ–±–∫–∏  

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- Node.js 14+
- npm

**–ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å:**
1. `cd naves-calc/api/`
2. `npm install`
3. `npm start`
4. –í `index.html` —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—É—Ç—å: `http://localhost:3000/api/orders`
5. –ì–æ—Ç–æ–≤–æ!

---

## ‚öôÔ∏è –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –î–ª—è PHP:

**–®–∞–≥ 1:** –û–±–Ω–æ–≤–∏—Ç–µ –ø—É—Ç—å –≤ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–µ

–û—Ç–∫—Ä–æ–π—Ç–µ `naves-calc/index.html`, –Ω–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É 1865:
```javascript
const orderManager = new OrderManager('/api/orders');
```

–ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞:
```javascript
const orderManager = new OrderManager('/naves-calc/api/orders.php');
```

**–®–∞–≥ 2:** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
cd naves-calc/api/
cp config.example.php config.php
nano config.php
```

–ò–∑–º–µ–Ω–∏—Ç–µ:
```php
define('ADMIN_EMAIL', 'your-email@example.com');
```

–í `orders.php` —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ:
```php
require_once __DIR__ . '/config.php';
```

**–ì–æ—Ç–æ–≤–æ!** –¢–µ–ø–µ—Ä—å –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–∫–∞–∑–µ –≤–∞–º –±—É–¥–µ—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å email.

---

### –î–ª—è Node.js:

**–®–∞–≥ 1:** –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
cd naves-calc/api/
npm install
```

**–®–∞–≥ 2:** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
```bash
nano config.json
```

–í–∫–ª—é—á–∏—Ç–µ email:
```json
{
  "email": {
    "enabled": true,
    "to": "your-email@example.com",
    "smtp": {
      "host": "smtp.gmail.com",
      ...
    }
  }
}
```

**–®–∞–≥ 3:** –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
```bash
npm start
```

**–®–∞–≥ 4:** –û–±–Ω–æ–≤–∏—Ç–µ –ø—É—Ç—å –≤ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–µ

–í `index.html` (—Å—Ç—Ä–æ–∫–∞ 1865):
```javascript
const orderManager = new OrderManager('http://localhost:3000/api/orders');
```

**–ì–æ—Ç–æ–≤–æ!**

---

## üìß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### Email (Gmail):

1. –í–∫–ª—é—á–∏—Ç–µ 2FA: https://myaccount.google.com/security
2. –°–æ–∑–¥–∞–π—Ç–µ App Password: https://myaccount.google.com/apppasswords
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ App Password –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### Telegram (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞: [@BotFather](https://t.me/botfather)
2. –ü–æ–ª—É—á–∏—Ç–µ Chat ID: [@userinfobot](https://t.me/userinfobot)
3. –î–æ–±–∞–≤—å—Ç–µ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:

**PHP (config.php):**
```php
define('TELEGRAM_BOT_TOKEN', 'YOUR_TOKEN');
define('TELEGRAM_CHAT_ID', 'YOUR_CHAT_ID');
```

**Node.js (config.json):**
```json
{
  "telegram": {
    "enabled": true,
    "botToken": "YOUR_TOKEN",
    "chatId": "YOUR_CHAT_ID"
  }
}
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã endpoint:

**PHP:**
```bash
curl -X POST http://localhost/naves-calc/api/orders.php \
  -H "Content-Type: application/json" \
  -d '{"customerData":{"name":"Test","phone":"123"}}'
```

**Node.js:**
```bash
curl http://localhost:3000/health
```

### –¢–µ—Å—Ç –∏–∑ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞:

1. –û—Ç–∫—Ä–æ–π—Ç–µ `naves-calc/index.html`
2. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ:
   ```javascript
   makeOrder()
   ```
4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞–ø–∫—É `api/orders/` - —Ç–∞–º –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è —Ñ–∞–π–ª –∑–∞–∫–∞–∑–∞

---

## üìÅ –ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –∑–∞–∫–∞–∑—ã

### –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞:

–ö–∞–∂–¥—ã–π –∑–∞–∫–∞–∑ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ñ–∞–π–ª:
```
api/orders/ORD-20251105-1699213185-1234.json
```

### –õ–æ–≥ —Ñ–∞–π–ª:

–í—Å–µ –∑–∞–∫–∞–∑—ã —Ç–∞–∫–∂–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤:
```
api/orders/orders.log
```

–§–æ—Ä–º–∞—Ç:
```
[2025-11-05 22:00:00] ORD-xxx | –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤ | +7 999 123-45-67 | 150 000 ‚ÇΩ
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### ‚úÖ –ß—Ç–æ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:

- `.htaccess` –∑–∞—â–∏—Ç–∞ –ø–∞–ø–∫–∏ orders
- CORS –∑–∞–≥–æ–ª–æ–≤–∫–∏
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è phone/email
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∑–∞–ø—Ä–æ—Å–∞

### ‚ö†Ô∏è –ß—Ç–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å:

1. **HTTPS** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
2. **Rate Limiting** - –æ–≥—Ä–∞–Ω–∏—á—å—Ç–µ —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø—Ä–æ—Å–æ–≤
3. **Captcha** - –∑–∞—â–∏—Ç–∞ –æ—Ç –±–æ—Ç–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
4. **Backup** - —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤

---

## üìä –ß—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –∑–∞–∫–∞–∑–µ

```json
{
  "orderId": "ORD-20251105-...",
  "timestamp": 1699213185000,
  "date": "2025-11-05 22:00:00",
  "ip": "192.168.1.1",
  "customerData": {
    "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
    "phone": "+7 999 123-45-67",
    "email": "ivan@example.com",
    "address": "–ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, 10",
    "comment": "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫–ª–∏–µ–Ω—Ç–∞"
  },
  "calculationData": {
    "length": 11,
    "width": 6,
    "area": "66.00",
    "roofType": "var-2",
    "postMaterial": "glued-150x150",
    "roofingMaterial": "metal-grandline",
    "totalPrice": "150 000 ‚ÇΩ",
    ...–≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞–≤–µ—Å–∞...
  }
}
```

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:
1. ‚úÖ –í—ã–±–µ—Ä–∏—Ç–µ PHP –∏–ª–∏ Node.js
2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ endpoint –≤ `index.html`
3. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –æ—Ç–ø—Ä–∞–≤–∫—É –∑–∞–∫–∞–∑–∞
4. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ:
- ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- üîí –î–æ–±–∞–≤—å—Ç–µ HTTPS
- üìä –°–æ–∑–¥–∞–π—Ç–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∑–∞–∫–∞–∑–æ–≤
- üíæ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup
- üìß –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–æ—Ç–≤–µ—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞–º

---

## üìû –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–∏–µ–º—É –∑–∞–∫–∞–∑–æ–≤!

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ endpoint –≤–∞—à –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω:

- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞—Å—á–µ—Ç–æ–≤ –≤ localStorage
- ‚úÖ –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ —á–µ—Ä–µ–∑ backend
- ‚úÖ Email/Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF
- ‚úÖ –ö—Ä–∞—Å–∏–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ —Ñ–∞–π–ª–µ:
**`naves-calc/api/README.md`**

–¢–∞–º –æ–ø–∏—Å–∞–Ω—ã:
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ email –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram –±–æ—Ç–∞
- –†–µ—à–µ–Ω–∏–µ —Ç–∏–ø–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º
- –ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

---

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 05.11.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

üéâ **–£—Å–ø–µ—Ö–æ–≤ —Å –ø—Ä–æ–¥–∞–∂–∞–º–∏!**

