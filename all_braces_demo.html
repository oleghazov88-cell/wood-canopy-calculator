<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ğ’ÑĞµ 4 Ñ‚Ğ¸Ğ¿Ğ° Ñ€Ğ°ÑĞºĞ¾ÑĞ¾Ğ² - Demo</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0a0a0a;
        }
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 10px;
            font-size: 14px;
            max-width: 350px;
            z-index: 100;
            border: 1px solid #333;
        }
        #info h2 {
            margin: 0 0 15px 0;
            font-size: 20px;
            color: #4fc3f7;
        }
        .brace-info {
            background: rgba(255, 255, 255, 0.05);
            padding: 10px;
            margin: 8px 0;
            border-radius: 5px;
            border-left: 3px solid #4fc3f7;
        }
        .brace-info h3 {
            margin: 0 0 5px 0;
            font-size: 14px;
            color: #ffa726;
        }
        .brace-info p {
            margin: 3px 0;
            font-size: 12px;
            color: #ddd;
        }
        .highlight {
            color: #66bb6a;
            font-weight: bold;
        }
        #stats {
            position: absolute;
            bottom: 10px;
            left: 10px;
            color: white;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 10px;
            font-size: 12px;
            border: 1px solid #333;
        }
        #controls {
            position: absolute;
            top: 10px;
            right: 10px;
            color: white;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 10px;
            font-size: 12px;
            border: 1px solid #333;
        }
        button {
            background: #1976d2;
            color: white;
            border: none;
            padding: 8px 15px;
            margin: 3px;
            cursor: pointer;
            border-radius: 5px;
            font-size: 12px;
            transition: background 0.3s;
        }
        button:hover {
            background: #2196f3;
        }
        button.active {
            background: #4caf50;
        }
    </style>
</head>
<body>
    <div id="info">
        <h2>ğŸ”§ Ğ’ÑĞµ 4 Ñ‚Ğ¸Ğ¿Ğ° Ñ€Ğ°ÑĞºĞ¾ÑĞ¾Ğ²</h2>
        <div style="background: rgba(255, 193, 7, 0.1); padding: 8px; border-radius: 5px; border-left: 3px solid #ffc107; margin-bottom: 12px; font-size: 12px;">
            ğŸ“ <strong>Ğ Ğ°Ğ·Ğ¼ĞµÑ€Ñ‹ Ğ² Ğ¼Ğ¸Ğ»Ğ»Ğ¸Ğ¼ĞµÑ‚Ñ€Ğ°Ñ… (Ğ¼Ğ¼)</strong><br>
            ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ñ: Ğ´ÑĞ¹Ğ¼Ñ‹ Ã— 25.4 â†’ Ğ¼Ğ¼
        </div>
        
        <div class="brace-info">
            <h3>R1 - ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ğ¹</h3>
            <p><strong>100Ã—500Ã—500 Ğ¼Ğ¼</strong></p>
            <p>Ğ’ĞµÑ€ÑˆĞ¸Ğ½Ñ‹: <span class="highlight">24</span> | Ğ¢Ñ€ĞµÑƒĞ³: <span class="highlight">36</span></p>
        </div>
        <div class="brace-info">
            <h3>R2 - ĞšÑ€ĞµÑÑ‚Ğ¾Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ½Ñ‹Ğ¹</h3>
            <p><strong>100Ã—400Ã—400 Ğ¼Ğ¼</strong></p>
            <p>Ğ’ĞµÑ€ÑˆĞ¸Ğ½Ñ‹: <span class="highlight">162</span> | Ğ¢Ñ€ĞµÑƒĞ³: <span class="highlight">100</span></p>
        </div>
        <div class="brace-info">
            <h3>R3 - Ğ”Ğ²Ğ¾Ğ¹Ğ½Ğ¾Ğ¹</h3>
            <p><strong>100Ã—400Ã—400 Ğ¼Ğ¼</strong></p>
            <p>Ğ’ĞµÑ€ÑˆĞ¸Ğ½Ñ‹: <span class="highlight">186</span> | Ğ¢Ñ€ĞµÑƒĞ³: <span class="highlight">108</span></p>
        </div>
        <div class="brace-info">
            <h3>R4 - Ğ£Ğ³Ğ»Ğ¾Ğ²Ğ¾Ğ¹</h3>
            <p><strong>100Ã—500Ã—500 Ğ¼Ğ¼</strong></p>
            <p>Ğ’ĞµÑ€ÑˆĞ¸Ğ½Ñ‹: <span class="highlight">471</span> | Ğ¢Ñ€ĞµÑƒĞ³: <span class="highlight">252</span></p>
        </div>
    </div>

    <div id="controls">
        <h3 style="margin: 0 0 10px 0; color: #4fc3f7;">Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ</h3>
        <button id="rotateBtn" class="active">Ğ’Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ğµ: Ğ’ĞšĞ›</button><br>
        <button id="wireframeBtn">ĞšĞ°Ñ€ĞºĞ°Ñ: Ğ’Ğ«ĞšĞ›</button><br>
        <button id="resetBtn">Ğ¡Ğ±Ñ€Ğ¾ÑĞ¸Ñ‚ÑŒ ĞºĞ°Ğ¼ĞµÑ€Ñƒ</button>
    </div>

    <div id="stats">
        <strong>Ğ’ÑĞµĞ³Ğ¾:</strong><br>
        Ğ’ĞµÑ€ÑˆĞ¸Ğ½Ñ‹: <span class="highlight">843</span><br>
        Ğ¢Ñ€ĞµÑƒĞ³Ğ¾Ğ»ÑŒĞ½Ğ¸ĞºĞ¸: <span class="highlight">496</span><br>
        Ğ Ğ°Ğ·Ğ¼ĞµÑ€ ĞºĞ¾Ğ´Ğ°: <span class="highlight">~86KB</span><br>
        <br>
        <strong>Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°:</strong> <span class="highlight">Ğ¼Ğ³Ğ½Ğ¾Ğ²ĞµĞ½Ğ½Ğ°Ñ</span><br>
        <strong>GLTFLoader:</strong> <span class="highlight">Ğ½Ğµ Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ</span>
    </div>

    <script type="importmap">
    {
        "imports": {
            "three": "./naves-calc/assets/libs/three/three.module.min.js",
            "three/addons/": "./naves-calc/assets/libs/three/"
        }
    }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from './naves-calc/assets/libs/three/OrbitControls.js';
        import { createBraceR1 } from './naves-calc/assets/js/partGeometry_r1.js';
        import { createBraceR2 } from './naves-calc/assets/js/partGeometry_r2.js';
        import { createBraceR3 } from './naves-calc/assets/js/partGeometry_r3.js';
        import { createBraceR4 } from './naves-calc/assets/js/partGeometry_r4.js';

        console.log('ğŸš€ Loading all 4 brace types...');
        const startTime = performance.now();

        // Ğ¡Ñ†ĞµĞ½Ğ°
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x0a0a0a);
        scene.fog = new THREE.Fog(0x0a0a0a, 30, 100);

        // ĞšĞ°Ğ¼ĞµÑ€Ğ°
        const camera = new THREE.PerspectiveCamera(
            60,
            window.innerWidth / window.innerHeight,
            1,
            50000
        );
        camera.position.set(0, 400, 1200); // Ğ² Ğ¼Ğ¼
        camera.lookAt(0, 200, 0);

        // Ğ ĞµĞ½Ğ´ĞµÑ€ĞµÑ€
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        document.body.appendChild(renderer.domElement);

        // ĞšĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»Ñ‹
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        controls.target.set(0, 200, 0); // Ğ² Ğ¼Ğ¼

        // ĞÑĞ²ĞµÑ‰ĞµĞ½Ğ¸Ğµ
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.4);
        scene.add(ambientLight);

        const directionalLight1 = new THREE.DirectionalLight(0xffffff, 0.8);
        directionalLight1.position.set(20, 30, 10);
        directionalLight1.castShadow = true;
        scene.add(directionalLight1);

        const directionalLight2 = new THREE.DirectionalLight(0x4fc3f7, 0.3);
        directionalLight2.position.set(-20, 20, -10);
        scene.add(directionalLight2);

        // Ğ’ÑĞ¿Ğ¾Ğ¼Ğ¾Ğ³Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹ (Ğ² Ğ¼Ğ¼)
        const gridHelper = new THREE.GridHelper(3000, 60, 0x222222, 0x111111); // 3000Ğ¼Ğ¼ = 3Ğ¼
        scene.add(gridHelper);

        // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ğ¼ Ğ²ÑĞµ 4 Ñ€Ğ°ÑĞºĞ¾ÑĞ°
        const braces = [];
        const spacing = 350; // Ğ Ğ°ÑÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ¼ĞµĞ¶Ğ´Ñƒ Ñ€Ğ°ÑĞºĞ¾ÑĞ°Ğ¼Ğ¸ Ğ² Ğ¼Ğ¼
        
        // ĞšĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ ĞºĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ğ¸ Ğ´ÑĞ¹Ğ¼Ñ‹ â†’ Ğ¼Ğ¸Ğ»Ğ»Ğ¸Ğ¼ĞµÑ‚Ñ€Ñ‹
        const INCH_TO_MM = 25.4;

        // R1 - ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ğ¹
        const braceR1 = createBraceR1();
        braceR1.scale.setScalar(INCH_TO_MM); // ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ² Ğ¼Ğ¼
        braceR1.position.set(-spacing * 1.5, 0, 0);
        braceR1.castShadow = true;
        braceR1.receiveShadow = true;
        scene.add(braceR1);
        braces.push({ mesh: braceR1, name: 'R1', speed: 0.003 });

        // ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑÑŒ R1
        const labelR1 = createLabel('R1', -spacing * 1.5, -50, 0);
        scene.add(labelR1);

        // R2 - ĞšÑ€ĞµÑÑ‚Ğ¾Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ½Ñ‹Ğ¹
        const braceR2 = createBraceR2();
        braceR2.scale.setScalar(INCH_TO_MM); // ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ² Ğ¼Ğ¼
        braceR2.position.set(-spacing * 0.5, 0, 0);
        braceR2.castShadow = true;
        braceR2.receiveShadow = true;
        scene.add(braceR2);
        braces.push({ mesh: braceR2, name: 'R2', speed: 0.004 });

        // ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑÑŒ R2
        const labelR2 = createLabel('R2', -spacing * 0.5, -50, 0);
        scene.add(labelR2);

        // R3 - Ğ”Ğ²Ğ¾Ğ¹Ğ½Ğ¾Ğ¹
        const braceR3 = createBraceR3();
        braceR3.scale.setScalar(INCH_TO_MM); // ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ² Ğ¼Ğ¼
        braceR3.position.set(spacing * 0.5, 0, 0);
        braceR3.castShadow = true;
        braceR3.receiveShadow = true;
        scene.add(braceR3);
        braces.push({ mesh: braceR3, name: 'R3', speed: 0.005 });

        // ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑÑŒ R3
        const labelR3 = createLabel('R3', spacing * 0.5, -50, 0);
        scene.add(labelR3);

        // R4 - Ğ£Ğ³Ğ»Ğ¾Ğ²Ğ¾Ğ¹
        const braceR4 = createBraceR4();
        braceR4.scale.setScalar(INCH_TO_MM); // ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ² Ğ¼Ğ¼
        braceR4.position.set(spacing * 1.5, 0, 0);
        braceR4.castShadow = true;
        braceR4.receiveShadow = true;
        scene.add(braceR4);
        braces.push({ mesh: braceR4, name: 'R4', speed: 0.006 });

        // ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑÑŒ R4
        const labelR4 = createLabel('R4', spacing * 1.5, -50, 0);
        scene.add(labelR4);

        const loadTime = performance.now() - startTime;
        console.log(`âœ… All 4 braces loaded in ${loadTime.toFixed(2)}ms`);

        // Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞ¸
        function createLabel(text, x, y, z) {
            const canvas = document.createElement('canvas');
            canvas.width = 128;
            canvas.height = 64;
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = '#4fc3f7';
            ctx.font = 'bold 32px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(text, 64, 32);

            const texture = new THREE.CanvasTexture(canvas);
            const material = new THREE.SpriteMaterial({ map: texture });
            const sprite = new THREE.Sprite(material);
            sprite.position.set(x, y, z);
            sprite.scale.set(100, 50, 1); // Ğ² Ğ¼Ğ¼
            return sprite;
        }

        // ĞŸĞ¾Ğ» Ğ´Ğ»Ñ Ñ‚ĞµĞ½ĞµĞ¹ (Ğ² Ğ¼Ğ¼)
        const planeGeometry = new THREE.PlaneGeometry(4000, 4000); // 4Ğ¼ Ã— 4Ğ¼
        const planeMaterial = new THREE.ShadowMaterial({ opacity: 0.4 });
        const plane = new THREE.Mesh(planeGeometry, planeMaterial);
        plane.rotation.x = -Math.PI / 2;
        plane.position.y = -50;
        plane.receiveShadow = true;
        scene.add(plane);

        // Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
        let rotating = true;
        let wireframe = false;

        document.getElementById('rotateBtn').addEventListener('click', function() {
            rotating = !rotating;
            this.textContent = `Ğ’Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ğµ: ${rotating ? 'Ğ’ĞšĞ›' : 'Ğ’Ğ«ĞšĞ›'}`;
            this.classList.toggle('active');
        });

        document.getElementById('wireframeBtn').addEventListener('click', function() {
            wireframe = !wireframe;
            braces.forEach(b => {
                b.mesh.material.wireframe = wireframe;
            });
            this.textContent = `ĞšĞ°Ñ€ĞºĞ°Ñ: ${wireframe ? 'Ğ’ĞšĞ›' : 'Ğ’Ğ«ĞšĞ›'}`;
            this.classList.toggle('active');
        });

        document.getElementById('resetBtn').addEventListener('click', function() {
            camera.position.set(0, 15, 40);
            controls.target.set(0, 8, 0);
            controls.update();
        });

        // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ° Ğ¾ĞºĞ½Ğ°
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // ĞĞ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ñ
        function animate() {
            requestAnimationFrame(animate);
            
            if (rotating) {
                braces.forEach(b => {
                    b.mesh.rotation.y += b.speed;
                });
            }
            
            controls.update();
            renderer.render(scene, camera);
        }

        animate();

        // ĞšĞ¾Ğ½ÑĞ¾Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ²Ñ‹Ğ²Ğ¾Ğ´
        console.log(`
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   All 4 Brace Types - Loaded!         â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ R1: 24 vertices, 36 triangles         â•‘
â•‘ R2: 162 vertices, 100 triangles       â•‘
â•‘ R3: 186 vertices, 108 triangles       â•‘
â•‘ R4: 471 vertices, 252 triangles       â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ Total: 843 vertices, 496 triangles    â•‘
â•‘ Load time: ${loadTime.toFixed(2)}ms                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        `);
    </script>
</body>
</html>




